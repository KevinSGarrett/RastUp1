version: 1
capabilities:
  blueprint_concordance:
    status: planned          # planned | in_progress | done
    description: >
      Index NT/TD blueprints, maintain a crosswalk, and enforce coverage via CI.
    files:
      - docs/blueprints/nt-index.json
      - docs/blueprints/td-index.json
      - docs/blueprints/crosswalk.json
      - ci/concordance-check.yml

  access_readiness:
    status: planned
    description: >
      Access Readiness Matrix, smoke tests, entitlements, and autopilot gating.
    files:
      - docs/runbooks/access-readiness-matrix.md
      - scripts/smoke/
      - ci/smoke.yml
      - ops/access/entitlements.yaml

  progress_model:
    status: planned
    description: >
      WBS-based progress computation, PROGRESS.md, and OUTLINE.md updates.
    files:
      - docs/PROGRESS.md
      - ops/por.json
      - docs/OUTLINE.md

  run_review:
    status: in_progress
    description: >
      Orchestrator manager + assistant-manager flow for reviewing latest agent
      run reports, deciding acceptance, and updating WBS/task status. Includes
      CI-aware gating so work is never marked DONE when tests are red.
    files:
      - docs/orchestrator/reviews/
      - docs/runs/
      - docs/orchestrator/decision-log.md
      - orchestrator/review_latest.py
      - orchestrator/apply_latest_review.py
      - orchestrator/review_all_in_progress.py
    commands:
      - python -m orchestrator.review_latest
      - python -m orchestrator.apply_latest_review .
      - python -m orchestrator.review_all_in_progress
      - python -m orchestrator.autopilot_loop

  security_and_secrets:
    status: planned
    description: >
      Secrets policy, rotation ledger, and security/dependency CI gates.
    files:
      - ops/secrets/rotation.jsonl
      - docs/security/threat-model.md
      - ci/security.yml
      - ci/deps-license.yml

  lock_and_ownership:
    status: planned
    description: >
      Lock files, ownership map, and CODEOWNERS mapping for non-interference.
    files:
      - ops/locks/
      - ops/ownership.yaml
      - .github/CODEOWNERS

  model_and_tools_logging:
    status: planned
    description: >
      Record which models/tools/plugins were used for which WBS items and why.
    files:
      - ops/model-decisions.jsonl
      - ops/tools-manifest.json

  recovery_and_rotation:
    status: planned
    description: >
      Orchestrator/agent recovery SOPs, session rotation, and attach-pack usage.
    files:
      - docs/orchestrator/primer.md
      - docs/orchestrator/rotations/

  auto_remediation:
    status: planned
    description: >
      Automatic remediation loop for failing tests/CI and unmet acceptance
      criteria. The assistant-manager (Anthropic) analyses run reports and
      reviews, proposes concrete fixes, and the orchestrator dispatches Cursor
      agents to apply changes and re-run validation until CI is green.
    files:
      - orchestrator/autopilot_loop.py
      - orchestrator/review_latest.py
      - orchestrator/apply_latest_review.py
      - docs/orchestrator/decision-log.md
      - docs/orchestrator/reviews/
      - docs/runs/
    commands:
      - python -m orchestrator.review_latest
      - python -m orchestrator.apply_latest_review .
      - python -m orchestrator.autopilot_loop
