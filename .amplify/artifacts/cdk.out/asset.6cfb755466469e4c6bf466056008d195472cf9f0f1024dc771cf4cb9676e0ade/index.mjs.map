{
  "version": 3,
  "sources": ["../../../../node_modules/@aws-amplify/backend-function/src/lambda-shims/cjs_shim.ts", "../../../../amplify/functions/viewer/handler.ts"],
  "sourcesContent": ["import { createRequire } from 'node:module';\nimport path from 'node:path';\nimport url from 'node:url';\nglobal.require = createRequire(import.meta.url);\nglobal.__filename = url.fileURLToPath(import.meta.url);\nglobal.__dirname = path.dirname(__filename);\n", "// amplify/functions/viewer/handler.ts\r\n\r\ntype Viewer = {\r\n  id: string;\r\n  email: string | null;\r\n  groups: string[];\r\n};\r\n\r\nexport const handler = async (event: any): Promise<Viewer> => {\r\n  const identity = event?.identity ?? {};\r\n  const claims = identity?.claims ?? {};\r\n\r\n  const sub =\r\n    identity?.sub ??\r\n    identity?.userId ??\r\n    claims.sub ??\r\n    claims[\"cognito:username\"] ??\r\n    \"anonymous\";\r\n\r\n  const email =\r\n    claims.email ??\r\n    claims[\"custom:email\"] ??\r\n    null;\r\n\r\n  const groupsRaw =\r\n    claims[\"cognito:groups\"] ??\r\n    identity?.groups ??\r\n    [];\r\n\r\n  const groups = Array.isArray(groupsRaw) ? groupsRaw : [];\r\n\r\n  return {\r\n    id: String(sub),\r\n    email: email ? String(email) : null,\r\n    groups: groups.map(String),\r\n  };\r\n};\r\n"],
  "mappings": ";AAAA,OAAS,iBAAAA,MAAqB,cAC9B,OAAOC,MAAU,YACjB,OAAOC,MAAS,WAChB,OAAO,QAAUF,EAAc,YAAY,GAAG,EAC9C,OAAO,WAAaE,EAAI,cAAc,YAAY,GAAG,EACrD,OAAO,UAAYD,EAAK,QAAQ,UAAU,ECGnC,IAAME,EAAU,MAAOC,GAAgC,CAC5D,IAAMC,EAAWD,GAAO,UAAY,CAAC,EAC/BE,EAASD,GAAU,QAAU,CAAC,EAE9BE,EACJF,GAAU,KACVA,GAAU,QACVC,EAAO,KACPA,EAAO,kBAAkB,GACzB,YAEIE,EACJF,EAAO,OACPA,EAAO,cAAc,GACrB,KAEIG,EACJH,EAAO,gBAAgB,GACvBD,GAAU,QACV,CAAC,EAEGK,EAAS,MAAM,QAAQD,CAAS,EAAIA,EAAY,CAAC,EAEvD,MAAO,CACL,GAAI,OAAOF,CAAG,EACd,MAAOC,EAAQ,OAAOA,CAAK,EAAI,KAC/B,OAAQE,EAAO,IAAI,MAAM,CAC3B,CACF",
  "names": ["createRequire", "path", "url", "handler", "event", "identity", "claims", "sub", "email", "groupsRaw", "groups"]
}
