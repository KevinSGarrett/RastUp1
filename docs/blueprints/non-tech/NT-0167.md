<!-- id: NT-0167 | source: ProjectPlans\Combined_Master_PLAIN_Non_Tech_001.docx | range: 601200-605200 -->

ne row per campaign per day

Keys: dt, promotion_campaign_id, service_profile_id, city_id, role, type
(boost\|featured)

Spend & delivery: spend_cents, clicks_valid, clicks_invalid, impressions
(featured)

Outcomes: inquiries, bookings, gmv_attributed_cents,
gmv_incremental_cents (holdoutestimated), cpb_cents (cost per booking)

8\) gold.fact_search --- Query performance

Grain: one row per (dt, city, role, query_hash)

Columns: dt, city_id, role, query_hash, queries, results_avg,
ctr_overall, ctr_promoted, zero_result_rate

9\) gold.fact_thread_activity --- Messaging health

Grain: one row per thread per day

Columns: dt, message_thread_id, city_id, role_pair (buyer→model etc.),
messages_sent, first_response_seconds, median_response_seconds,
participants_count, attachments_count

10\) gold.fact_support_case --- Support workload & outcomes

Grain: one row per support case

Columns: dt = date(opened_at), support_case_id, type, origin
(buyer\|seller\|system), lbg_id (nullable), opened_at, resolved_at,
sla_breached (bool), outcome_code, refund_cents

11\) gold.fact_ts_case --- Trust & Safety actions

Grain: one row per T&S case

Columns: dt = date(opened_at), ts_case_id, type, severity, source
(report\|auto), sanctions_count, ib_suppressed_days, resolved_at

12\) gold.fact_docs --- Contracting completeness

Grain: one row per doc (doc_id)

Columns: dt = date(created_at), doc_id, booking_leg_id, template_id,
kind (sow\|release\|house_rules\|change_order), signed (bool), signed_at

13\) gold.fact_social_snapshot --- Perplatform social metrics (verified)

Grain: one row per service_profile × platform × day

Columns: dt, service_profile_id, platform
(ig\|yt\|tt\|x\|linkedin\|fb\|snap), followers, avg_views,
engagement_rate_bp (basis points), growth_30d_bp, verified_source (bool)

D\) Keys, Indexes & Joins

Primary keys: natural + dt where daily rollups (e.g.,
promotion_campaign_id, dt).

Indexes/clustering: city_id, role, booking_leg_id/lbg_id (per §5.4).

Join recipes:

Provider earnings: fact_payout_leg → fact_booking_leg →
dim_service_profile → dim_user.

Group receipts: fact_lbg → fact_booking_leg (legs) →
dim_service_profile + dim_studio → fact_payment_line.

ROAS: fact_promo ↔ fact_booking_leg (attribution window) → fact_lbg for
GMV totals.

E\) Sample record (abbreviated)

gold.fact_booking_leg

dt=20251112

booking_leg_id=leg_01HE9Z8R3C

lbg_id=lbg_01HE9Z7A5S

city_id=city_houston

leg_role=talent

service_role=model

service_profile_id=srv_mdl_81a2

provider_user_id=usr_mdl456

buyer_user_id=usr_byr111

start_at=20251112T20:00:00Z

end_at=20251112T22:00:00Z

instant_book=true

subtotal_cents=30000

addons_cents=5000

travel_cents=2000

license_cents=0

discounts_cents=0

provider_fee_cents=3465

buyer_fee_cents_alloc=1575

tax_cents_alloc=0

processor_fee_cents_alloc=900

net_to_provider_cents=33535

status=completed

deposit_auth_cents=null

(Illustrative numbers; allocations tie to fact_payment.)

F\) Dataquality rules (Gold)

fact_payment.amount_cents = Σ fact_payment_line.line_cents (by charge).

Σ perleg allocations = parent totals (buyer_fee, tax, processor fees)
within rounding tolerance.

fact_payout.amount_cents = Σ fact_payout_leg.net_to_provider_cents.

Every review_id in Silver must map to a completed fact_booking_leg.

fact_social_snapshot.verified_source=true only when platform connection
valid at capture time.

G\) Acceptance Criteria (mark §5.5 FINAL)

Dims created with SCD2 (dim_user, dim_service_profile, dim_studio,
dim_city, dim_policy, dim_promotion_campaign, dim_doc_template).

Facts created with grains & columns as above (fact_lbg,
fact_booking_leg, fact_payment + fact_payment_line, fact_payout +
fact_payout_leg, fact_deposit, fact_tax, fact_promo, fact_search,
fact_thread_activity, fact_support_case, fact_ts_case, fact_docs,
fact_social_snapshot).

Partitioning/clustering follow §5.4; money in cents; timestamps
consistent.

Allocation math implemented & reconciles to §5.3 finance close; DQ tests
green.