<!-- id: NT-0185 | source: ProjectPlans\Combined_Master_PLAIN_Non_Tech_001.docx | range: 666000-670000 -->

 ops.

A\) Scope & Principles

Freshness first where it matters (ops dashboards, fraud/risk, inbox
hygiene). Accuracy first for finance/tax close.

Budget as a product: visible, predictable limits with selfserve requests
and audit trails (no hidden throttles).

Push computation to the edges: preaggregate hot metrics, partition
properly, cache aggressively.

Make waste obvious: top query offenders, unused MVs, stale tiles, and
overwide scans are surfaced in Admin Analytics (§4.14.12).

B\) Freshness SLOs & Error Budgets

SLO = the target. Error budget = permissible miss window per week/city.\
We track both p95 freshness and absolute deadlines; breaches consume
error budget.

Rules

P0 breach: Miss finance close or T&S feed → page SRE + Finance/T&S; gate
payouts (see §5.8).

P1 breach: Promotions/ops freshness SLO missed beyond budget → throttle
heavy adhoc queries; raise compute class (below).

C\) Cost Centers & Budget Guardrails (launch)

We expose budgets as monthly caps with weekly pacing and alert
thresholds (70%/90%/100%). Amounts are configdriven in Admin (§4.14.12
D11).

Alerting: 70% (info), 90% (action required), 100% (throttle/kill
switches per §4.14.2).

D\) Access Budgets & Team Quotas

We enforce perteam daily TB scan quotas, concurrency limits, and safe
query rules. Quotas are visible to users ("budget bar" in query UI).

Safe Query Rules

Mandatory partition predicates on dt and city or role for facts \> 30
days.

Kill if scan \> threshold (e.g., 2 TB) or wildcard select without
predicate on large tables.

No vault joins for nonLegal/Tax roles (blocked).

Result set cap: 5M rows (exports), else require approval.

E\) Compute Classes & Scheduling

We define compute classes with priority, autoscaling, and max spend:

Windows

Finance close: 00:30--06:00 local.

Backfills: 22:00--06:00 (city local); autopause if S1/S2 lag \> SLO.

F\) Materialization & Caching Plan (costsavvy)

Hot MVs (hourly): marketplace KPIs, promotions ROAS, search CTR
(day×city×role).

Result cache: 15--60 min for popular tiles; cachebusting only on input
change.

Prejoin views: conforming dims (time, city, role) to avoid wide
selfjoins.

Approximate queries: enable HyperLogLog/countdistinct sketches for
exploration; exact on publish.

Autoprune unused MVs (30 days) with review.

G\) Monitoring, Dashboards & Alerts

Admin Analytics (§4.14.12) adds:

Spend by schema/table (top N), TB scanned, credits used, and egress
(day/week/month).

Freshness gauges per table family vs SLO.

Budget bars per team; clickthrough to heaviest queries & visual EXPLAIN.

Error budget burndown (weekly) with forecast of breach.

Anomaly detection: sudden TB scan spikes, new Cartesian joins, or
missing partition filters → automessage query author with suggestions &
oneclick fix.

Alerts route to relevant owners + SRE with links to runbooks and kill
switches (feature flags in §4.14.2).

H\) Governance & Change Control

Budget changes: request in Admin → owner approval (Data Eng + Finance) →
effective next day; all changes logged.

Exception windows: planned workshops or monthend reporting can get
temporary boosts (timeboxed).

MV add/remove: RFC with cost/benefit; review after 30 days.

Backfill approval: required for S3/S4 jobs that would exceed weekly
compute plan.

I\) Developer & Analyst UX

Preflight checker in SQL editor: warns on missing dt/city_id filters,
shows estimated TB scan, suggests MV or sample.

Oneclick "Use Sample" for exploration (downsampled views).

"Why was my query killed?" panel: rule, threshold, and fix suggestions.

Selfserve burst: request +50% quota for 2 hours with justification;
autoapprove within set guardrails.

J\) Telemetry (cost & freshness)

cost.warehouse.credits_used • cost.tb_scanned • cost.object_storage_gb •
cost.egress_gb

freshness.table.p95_minutes (by table) • freshness.deadline.breach

budget.team.usage • budget.team.threshold_hit (70/90/100)

query.kill (reason, tb_estimate) • query.warn (missing_partition)

mv.hit/miss 