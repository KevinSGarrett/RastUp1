<!-- id: TD-0002 | source: ProjectPlans\TechnicalDevelopmentPlan.odt | range: 7200-11200 -->

anges
  Finance            N/A                                            N/A                                    N/A
  Legal/Compliance   Audit log access                               Lock records (litigation hold)         2-person
  ------------------ ---------------------------------------------- -------------------------------------- -------------------------------

All admin actions write immutable audits: actor, action, before/after,
reason.

**1.1.U Error model (API) & codes**

- *SP_INCOMPLETE* --- cannot publish: missing fields or portfolio too
  small.
- *SP_UNSAFE_PUBLIC* --- Safe-Mode restrictions prevent display.
- *SP_FORBIDDEN_LINK_STUDIO* --- link attempt by non-owner.
- *SP_CONFLICT_CALENDAR* --- hard overlap detected on accept/confirm.
- *SP_NOT_FOUND* --- unpublished or nonexistent role page.

Each error includes *error_code*, *message*, *hint*, *path*, and a
user-safe remediation tip.

**1.1.V Test plan (deterministic; CI-runnable)**

30. **Create & publish SP**: missing fields → *SP_INCOMPLETE*; add
    required fields + 6+ portfolio items → publish succeeds; role
    appears in search.
31. **Role-scoped reviews**: add review to Model SP; ensure Photographer
    SP rating untouched; studio rating untouched.
32. **Studio chip**: link/detach SP↔Studio; search result shows chip;
    ratings do not merge.
33. **Safe-Mode enforcement**: upload explicit preview → *nsfw_band=2*;
    guest sees blocked asset, logged-in with Safe-Mode ON sees blur or
    placeholder.
34. **Calendar block**: accept booking for Model SP; attempt overlapping
    booking for Photographer SP owned by same user → error.
35. **Index integrity**: mutate SP fields → index doc updates; nightly
    reindex parity within 1%; alert if not.
36. **Admin audits**: T&S override recorded with reason; City Ops
    toggles gate with two approvals.

**1.1.W Cost checklist (for this section)**

- Aurora Serverless v2 min ACUs ≤ 2 in prod; auto-pause in dev.
- Typesense single node (or OpenSearch Serverless minimal OCU cap).
- S3 lifecycle to Intelligent-Tiering for previews; 30-day expiration
  for orphaned assets.
- Content-scan Lambda throttle to cap concurrency (protects costs).

**§1.1 --- Finalization checklist**

We will mark **§1.1 FINAL** only when:

- SQL and GraphQL from this section are implemented and deployed.
- Validators for all roles are live; publish gate works.
- Search indices and indexers are live; result cards render correctly
  with Safe-Mode.
- Admin moderation + studio verification panels and audits are live.
- All tests in 1.1.V pass in CI.
- Cost alarms for DB, search, and S3 are configured and quiet for 48h
  under synthetic load.

# 

# 

# 

# 

# 

# **§1.2 --- Role‑Specific Search & Filters (Search Service, end‑to‑end)**

**Purpose.** Implement a fast, fair, and policy‑compliant discovery
system that reflects the product contract: role‑true discovery for
*people* (Service Profiles) and *places* (Studios), Safe‑Mode defaults,
city gates, verification gates, Instant‑Book, and promotions density
caps. This section fully specifies the **data model, indexes, analyzers,
API contracts, ranking, caching, telemetry, admin tools, tests, and cost
controls**. We will not move forward until this subsection is complete.

## **1.2.A Surfaces & UX contract**

**Where search appears**

47. **Search home** (role picker + location field + date and budget
    quick filters).
48. **Role‑scoped search** (tabs): *Models*, *Photographers*,
    *Videographers*, *Creators*.
49. **Studios search** (separate surface; can be "attached in flow"
    during checkout).
50. **Saved searches & alerts** (optional for MVP; schema below).
51. **Admin**: Reindex, synonyms, density caps, city gates,
    invalid‑click dashboard.

**Non‑negotiable behaviors**

- Clicking a search card **always** deep‑links to the **role canonical
  page** (*/u/{handle}/{role}*) or **studio page** (*/studio/{slug}*),
  never the account shell alone.
- Safe‑Mode ON by default for gu