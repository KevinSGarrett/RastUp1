<!-- id: TD-0220 | source: ProjectPlans\TechnicalDevelopmentPlan.odt | range: 792000-796000 -->

ut DisputeOpenInput { orderId: ID!, reason: String!, note: String,
attachments: \[ID!\] }*\
\
*type Mutation {*\
*proposeReschedule(input: RescheduleProposeInput!): ID!
\@aws_cognito_user_pools*\
*respondReschedule(input: RescheduleRespondInput!): Boolean!
\@aws_cognito_user_pools*\
\
*requestExtras(input: ExtrasRequestInput!): ID!
\@aws_cognito_user_pools*\
*respondExtras(input: ExtrasRespondInput!): Boolean!
\@aws_cognito_user_pools*\
\
*submitProofs(input: ProofsSubmitInput!): ID! \@aws_cognito_user_pools*\
*respondProofs(input: ProofsRespondInput!): Boolean!
\@aws_cognito_user_pools*\
\
*submitExpense(input: ExpenseSubmitInput!): ID!
\@aws_cognito_user_pools*\
*respondExpense(input: ExpenseRespondInput!): Boolean!
\@aws_cognito_user_pools*\
\
*submitComplete(input: CompleteSubmitInput!): ID!
\@aws_cognito_user_pools*\
*openDispute(input: DisputeOpenInput!): ID! \@aws_cognito_user_pools*\
*}*\

**Auth rules**

- Buyer and Provider on the order can create/respond to cards; admin can
  act with reason codes (audit logged).
- All media references go through **Media (§1.11)**; public surfaces
  obey **Safe‑Mode/SFW**.
- Reschedules can only be proposed on *confirmed\|in_progress* and not
  after *end_utc*.

## **1.14.5 Order state machine (authoritative)**

**States**: *created → authorized → confirmed → in_progress → completed
→ closed*\
**Terminal**: *cancelled*, *closed* (post‑completion administrative
close), *disputed* (parallel track with payments §1.13).

**Transitions & side effects**

- *authorized→confirmed*: convert **calendar hold → event** (§1.12); log
  *timeline_event(order.confirmed)*; send receipts (§1.13 & §1.10).
- *confirmed→in_progress*: at *start_utc − N min* mark in progress;
  notify parties.
- *in_progress→completed*: via **Complete Card** acceptance; schedule
  review window (§1.9).
- *confirmed\|in_progress→cancelled*: per policy snapshot; auto compute
  refunds (§1.13); release calendar; send notices.
- *any→disputed*: open dispute; payments evidence pack (§1.13); freeze
  reserves; publication hold on reviews (§1.9).
- *completed→closed*: automatic after review window or manual.

## **1.14.6 Action Card types --- schemas & lifecycles**

**Common fields (*****ord.card.payload*****)**

*{* \
*title?: string,* \
*note?: string,* \
*attachments?: \[assetId\],* \
*money?: { deltaCents?: int, items?: \[{code,label,qty,unitPriceCents}\]
},* \
*calendar?: { slots?: \[startUtc\], durationMin?: int },* \
*galleryId?: string,*\
*receipts?: \[assetId\]*\
*}*\

### **A) Reschedule**

- **Create (either side):** propose up to K candidate **slots** (UTC
  starts) with *durationMin*.
- **On create:** create **calendar holds** for each slot
  (source=*reschedule*) with TTL (e.g., 24h).
- **Respond:** counter‑propose (new Reschedule card) or **accept** one
  slot → convert accepted hold to **event**; release others.
- **Money impact:** optional delta if policy charges reschedule fee
  (card *money.deltaCents*) → charge via §1.13 (or skip).
- **Auto‑expire:** if within *lead_time* window, raise **critical
  exception** notifications (§1.10).
- **Close:** set card *ACCEPTED* or *DECLINED*; append timeline records.

### **B) Extras (scope/price change)**

- **Create:** provider proposes line items
  *{code,label,qty,unitPriceCents}*; computed delta shown to buyer.
- **Respond:** buyer accepts (charge delta via §1.13 capture or a new
  PI) or declines with reason.
- **Money:** on accept, update **price_snapshot** (append extra line
  items) and ledger; send new receipt.
- **Close:** accepted/declined; timeline append; if accepted \< start,
  fire Quiet‑Hour exception.

### **C) Proofs (approvals)**

- **Create (provider):** submit *galleryId* (watermarked) from **Media
  §1.11**; optional note.
- **Respond (buyer):** approve list of asset IDs or request changes with
  per‑asset notes; multiple rounds allowed until *expires_at*.
- **Close:** when all assets approved or provider marks "final"
  (configurable).
- **Delivera