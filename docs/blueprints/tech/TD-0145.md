<!-- id: TD-0145 | source: ProjectPlans\TechnicalDevelopmentPlan.odt | range: 522000-526000 -->

just‑in‑time case access** for
      message/content review.
2372. **Immutable audit.** Every admin action writes to an append‑only
      audit table and an object‑locked S3 stream (see §1.18).
2373. **Separation of duties.** Finance permissions are distinct from
      Trust & Safety (T&S) and Content Ops.
2374. **Privacy.** Admins view PII only when case‑bound and time‑boxed;
      all access is logged.
2375. **Cost.** One lightweight **Admin Next.js app** behind
      CloudFront + IP allowlist + SSO; serverless APIs (AppSync/Lambda),
      pay‑per‑use data access.

## **1.26.2 Roles & permissions (RBAC)**

**Roles (initial set)**

- *super_admin* (break‑glass; very limited holders)
- *trust_safety* (reports, DMCA, disputes, suspensions)
- *finance_ops* (refunds, holds, releases, reconciliation views)
- *support* (account lookups, resend emails, reset MFA, limited credits)
- *content_ops* (help/announcements/city content; SEO snippets)
- *search_curator* (pins, synonyms; §1.21)
- *docs_admin* (templates/versioning; §1.25)
- *engineering* (feature flags, config, read‑only observability)

**Recommended path:** *admin/rbac/policy.json*

*{*\
*\"trust_safety\": \[\"case:\*\", \"user:suspend\",
\"listing:unpublish\", \"message:read_case_bound\", \"audit:read\"\],*\
*\"finance_ops\": \[\"payment:refund\", \"payout:hold\|release\",
\"order:view\", \"recon:view\", \"audit:read\"\],*\
*\"support\": \[\"user:view\", \"user:resend_email\", \"mfa:reset\",
\"credits:grant_limited\", \"audit:read_own\"\],*\
*\"content_ops\": \[\"cms:\*\", \"announcement:\*\",
\"seo:snippet_edit\"\],*\
*\"search_curator\": \[\"search:pin\", \"search:synonym\"\],*\
*\"docs_admin\": \[\"docs:template_crud\", \"docs:envelope_view\"\],*\
*\"engineering\": \[\"flag:\*\", \"config:\*\", \"observability:\*\"\]*\
*}*\

**SSO.** OIDC (Google Workspace / Okta) with group→role mapping. Session
lifetime short; re‑auth for destructive actions.

## **1.26.3 App shell & security**

- **Admin app**: Next.js, SSR disabled (pure client + APIs) to minimize
  PII leakage.
- **Network**: CloudFront → WAF (bot/rate rules) → Admin API Gateway
  (JWT from SSO).
- **IP allowlist** for office/VPN; optional hardware key (WebAuthn)
  step‑up for finance/disputes.
- **Break‑glass**: short‑lived *super_admin* elevations require a ticket
  id + reason; auto‑revoked after TTL.

## **1.26.4 Data model (Aurora) --- cases, actions, audit**

**Recommended path:** *db/migrations/026_admin_core.sql*

*begin;*\
\
*create table admin_case (*\
*case_id text primary key, \-- cas\_\...*\
*kind text not null check (kind in
(\'report\',\'dmca\',\'dispute\',\'appeal\',\'fraud\')),*\
*status text not null check (status in
(\'new\',\'triage\',\'investigating\',\'awaiting_user\',\'resolved\',\'closed\')),*\
*priority int not null default 3, \-- 1 .. 5*\
*opened_by text not null, \-- usr\_\... or system*\
*subject_user text, \-- user primarily involved*\
*order_id text, \-- optional link*\
*thread_id text, \-- optional link*\
*listing_id text, \-- person/studio id*\
*summary text not null,*\
*sla_due_at timestamptz,*\
*created_at timestamptz default now(),*\
*updated_at timestamptz default now()*\
*);*\
\
*create table admin_action (*\
*action_id text primary key, \-- act\_\...*\
*case_id text references admin_case(case_id) on delete cascade,*\
*actor_admin text not null, \-- admin user id (oidc subject)*\
*action text not null, \--
\'suspend\',\'refund\',\'request_evidence\',\'note\',\'close\',\...*\
*payload jsonb,*\
*created_at timestamptz default now()*\
*);*\
\
*create table admin_audit (*\
*audit_id text primary key, \-- aud\_\...*\
*actor_admin text not null,*\
*resource text not null, \-- \'user:usr\_\...\',\'order:ord\_\...\'*\
*action text not null,*\
*payload jsonb,*\
*ip inet,*\
*user_agent text,*\
*created_at timestamptz default now()*\
*);*\
\
*commit;*\

**Immutable stream.** All *admin_audit* rows also appended to S3 with
**Object Lock** (WORM).

## **1.26.5 Modules & screens**

### **A) Us