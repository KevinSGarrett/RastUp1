<!-- id: TD-0169 | source: ProjectPlans\TechnicalDevelopmentPlan.odt | range: 608400-612400 -->

r doc)**

- *db/migrations/013_booking_core.sql* --- schema above.
- *api/schema/booking.graphql* --- GraphQL schema above.
- *ops/runbooks/booking-dispute.md* --- step‑by‑step dispute flow and
  evidence checklist (ties to Admin).
- *ops/policies/cancellation-matrix.md* --- default thresholds &
  examples.
- *api/webhooks/stripe-handlers.md* --- event mapping, idempotency,
  retries.
- *product/acceptance/booking-scenarios.md* --- enumerated scenarios
  (below).

## **1.3.16 Test plan (representative, not exhaustive)**

2761. **IB happy path**: rule allows → confirm → charge → calendar block
      → chat opens → complete → payout after window.

NonTechBlueprint

2762. **RTB**: request → provider accepts → charge → confirm; request
      auto‑expires if no response within SLA.

NonTechBlueprint

2763. **Counter‑offer**: provider counters → buyer accepts; totals
      recalc; prior request invalidated.
2764. **Smart Invite**: 1 brief → N recipients; award one or multiple;
      non‑awarded invites close.

NonTechBlueprint

2765. **Contracts**: pack generated, e‑signed, stored; visible in thread
      and Admin.

NonTechBlueprint

2766. **Completion**: time‑based vs milestone‑based; auto‑release after
      window if no dispute.

NonTechBlueprint

2767. **Cancellation matrix**: refunds computed per thresholds; provider
      cancel penalty applied; reschedule allowed before window.
2768. **Disputes**: open → evidence → Admin resolution; outcomes map to
      partial/full refund or payout.
2769. **Stripe webhooks**: success/failure, dispute created/closed,
      refund; idempotency proven.
2770. **Risk**: new provider payouts delayed; 3DS enforced where
      required; ACH pending state handled.
2771. **SEO/privacy**: no sensitive data indexed; SFW surfaces only.

## **1.3.17 Acceptance criteria --- mark §1.3 FINAL only when ALL true**

2772. IB, RTB, and Smart Invite flows work end‑to‑end with calendar
      blocks and chat threads.

NonTechBlueprint

2773. Checkout attaches and signs the correct **contract pack**;
      documents are retained with the order.

NonTechBlueprint

2774. Funds are charged and held on platform balance; **release/payout**
      logic respects completion + review windows; tipping supported.

NonTechBlueprint

2775. Cancellation & reschedule policies compute correct
      refunds/penalties; provider cancellations penalize reputation and
      (if repeated) fees.
2776. Disputes route to Admin casework with evidence; outcomes apply
      refunds/payouts; Stripe chargebacks are tracked.
2777. Webhooks are idempotent; retries safe; audit trails complete.
2778. Costs remain within launch posture (single PSP; serverless infra;
      no third‑party workflow SaaS).

# **§1.4 --- Messaging, Inbox & Collaboration --- Full Technical Spec (Part 1)**

**Purpose.** Deliver a **Unified Inbox** that powers safe, auditable
collaboration across **People** and **Studios** with **Message Requests
gating**, **Action Cards** (reschedule, extras, approvals, proofs,
expense, mark‑complete, dispute, safety flag), **Quiet
Hours/Do‑Not‑Disturb**, **push/email notifications & digests**, and
**anti‑circumvention nudges**---exactly mirroring your non‑technical
blueprint. This section will be delivered in multiple parts; I won't
exit §1.4 until it is ≥99.9% complete.

## **1.4.1 Scope confirmation**

- **Unified Inbox** (tabs/folders: *All*, *Action Required*, *Bookings*,
  *Offers/Requests*, *Archived*, *Spam/Blocked*).
- **Thread types**: Inquiry, Booking (talent), Studio Booking, Smart
  Invite, Support/T&S Case.
- **Message Requests**: accept/decline/block; credits and contact
  filters; anti‑spam throttles; rate limits for new accounts.
- **Action Cards** inside threads: **Propose/Reschedule**,
  **Extras/Overtime**, **Send Proofs/Approvals**, **Expense/Receipt**,
  **Mark Complete / Deliver**, **Dispute / Safety Flag**.
- **Notifications**: push/email real‑time + **daily/weekly digest**; ICS
  attachment for confirmed bookings.