<!-- id: TD-0059 | source: ProjectPlans\TechnicalDevelopmentPlan.odt | range: 212400-216400 -->

quiet hours,
cleanup expectations, insurance requirements.

- **Deposit policy** language must match *deposit_required* and
  *deposit_auth_cents*.
- Any change to house rules that materially affects obligations
  **invalidates** existing doc packs for future bookings → re‑issue
  required.

## **1.11.H Images, safety & SEO**

- Previews only; scanned for NSFW/PII per pipeline; Safe‑Mode ON for
  public; private pages show more but still SFW.
- **Ordering** by *position*; first image becomes listing thumbnail.
- **Alt text** derived from title/amenities for accessibility.
- Optional **virtual tour** (flagged; link rather than storage).

## **1.11.I Search facets (tie‑in to §1.2)**

- **Collection**: *studios_v1* (already defined).
- **Facets**: city, amenities\[\], verifiedStudio (bool),
  depositRequired (bool), capacity buckets, priceFromCents, ratingAvg,
  availability day buckets.
- **Sort**: default → text match → verified → rating → price distance
  from user budget → recency.
- **Safe‑Mode**: block nsfw_band=2 from thumbnails.

## **1.11.J Checkout & deposits (tie‑in to §1.3)**

- Studio leg participates in **atomic LBG confirm**.
- **Deposit auth** handled via **SetupIntent** (separate from GMV).
- **Overtime** & **extras** use the amendment flow (§1.3.K).
- **Deposit claims** handled post‑session with evidence (§1.3.N).
- Cancellation policy bands live in *studio_policy.cancellation_policy*.

## **1.11.K GraphQL API (AppSync) --- Studio management & browse**

*\# Types*\
*type Studio {*\
*studioId: ID!*\
*title: String!*\
*slug: String!*\
*description: String!*\
*city: String! region: String! country: String!*\
*geo: Geo!*\
*capacityPeople: Int!*\
*sizeSqft: Int*\
*amenities: \[String!\]!*\
*verifiedStudio: Boolean!*\
*depositRequired: Boolean!*\
*depositAuthCents: Int!*\
*houseRules: \[String!\]!*\
*insuranceConfirmed: Boolean!*\
*priceFromCents: Int!*\
*ratingAvg: Float!*\
*ratingCount: Int!*\
*media: \[Media!\]!*\
*isPublished: Boolean!*\
*}*\
\
*type StudioRate {*\
*rateId: ID!*\
*kind: String!*\
*name: String!*\
*dow: \[Int!\]!*\
*startLocal: String!*\
*endLocal: String!*\
*slotMinutes: Int*\
*priceCents: Int!*\
*overtimeCentsPer30m: Int!*\
*minBookingMinutes: Int!*\
*maxBookingMinutes: Int*\
*taxInclusive: Boolean!*\
*active: Boolean!*\
*}*\
\
*\# Queries*\
*type Query {*\
*studio(slug: String!): Studio!*\
*myStudios: \[Studio!\]!*\
*studioRates(studioId: ID!): \[StudioRate!\]!*\
*studioAvailability(studioId: ID!, from: AWSDateTime!, to:
AWSDateTime!): \[DateTimeRange!\]!*\
*}*\
\
*\# Mutations*\
*input StudioInput {*\
*title: String!, description: String!, city: String!, region: String!,
country: String!,*\
*lat: Float!, lon: Float!, address: AddressInput!,*\
*amenities: \[String!\]!, capacityPeople: Int!, sizeSqft: Int,*\
*depositRequired: Boolean!, depositAuthCents: Int!, houseRules:
\[String!\]!,*\
*insuranceConfirmed: Boolean!*\
*}*\
\
*type Mutation {*\
*createStudio(input: StudioInput!): Studio!*\
*updateStudio(studioId: ID!, input: StudioInput!): Studio!*\
*publishStudio(studioId: ID!): Studio!*\
*unpublishStudio(studioId: ID!): Studio!*\
\
*addStudioRate(studioId: ID!, rate: StudioRateInput!): StudioRate!*\
*updateStudioRate(rateId: ID!, rate: StudioRateInput!): StudioRate!*\
*deleteStudioRate(rateId: ID!): Boolean!*\
\
*addStudioMedia(studioId: ID!, media: MediaInput!): Media!*\
*reorderStudioMedia(studioId: ID!, order: \[ID!\]!): Boolean!*\
*deleteStudioMedia(mediaId: ID!): Boolean!*\
\
*addStudioBlackout(studioId: ID!, range: DateTimeRange!, reason:
String): Boolean!*\
*deleteStudioBlackout(blackoutId: ID!): Boolean!*\
\
*submitStudioVerification(studioId: ID!, docs: \[Upload!\]!): Boolean!*\
*}*\

**Guards & rules**

- Publish gate: required fields, minimum media, house rules present.
- Verification submission requires owner IDV passed (from §1.6).
- Media upload uses signed S3 URLs; scans run async; blocked images
  don't appear in public.

## **1.11.L Admin console (Studios)**

- **Verification qu