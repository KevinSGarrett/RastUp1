<!-- id: TD-0297 | source: ProjectPlans\TechnicalDevelopmentPlan.odt | range: 1069200-1073200 -->

 Grype).
- **SLAs**: Critical ≤ **48h**; High ≤ **7d**; Medium ≤ **30d**; Low at
  discretion. Track exceptions in *security/vuln_exceptions.yaml*
  (time‑boxed with owner).

**M.3 Update strategy**

- Dependency bot (Renovate) weekly; security PRs immediately.
- Lockfiles committed; **pinned versions** for critical libs (auth,
  crypto, uploads).
- Node LTS policy (upgrade within 60 days of new LTS availability).

**M.4 License policy**

- Allowed: MIT, Apache‑2.0, BSD‑2/3, ISC.
- Restricted: GPL family for distributed UI; legal review required for
  any copyleft.
- CI license check with denylist → build fails on violation.

**M.5 Provenance & signing (optional but recommended)**

- Build provenance via OIDC to AWS; record *build_info.json* (commit,
  runner, artifacts checksums).
- Container images optionally **signed** (cosign); store attestations
  under *security/attestations/*.

**M.6 NPM registry & tokens**

- Use org‑scoped tokens with read‑only; no tokens in CI logs; audit
  token scopes quarterly.

**M.7 Artifacts**

- *.github/workflows/security.yml* --- SCA/SAST/container scan & SBOM.
- *security/sbom/README.md* --- how to read SBOMs.
- *security/policies/dependency_policy.md* --- this appendix content.
- *security/vuln_sla.md* --- SLA details & exception workflow.

**M.8 Acceptance**

- Every release carries SBOMs for all services; **0 Critical vulns**
  open in prod; license check green; provenance attached.

## **Appendix N --- DR Matrix (RTO/RPO) & DR Runbooks (paste‑ready)**

**Purpose.** Meet recovery targets and practice restoration.

**N.1 Targets**

- Marketplace core (Aurora, AppSync/Lambdas): **RTO ≤ 60m**, **RPO ≤
  15m**.
- Search (Typesense): **RTO ≤ 240m**, **RPO ≤ 60m** (rebuild from
  outbox).
- Media (S3): **RTO ≤ 240m**, **RPO ≤ 60m** (versioned + replicated when
  enabled).

**N.2 Components & posture**

- **Aurora Serverless v2**: multi‑AZ; PITR 7--14d; optional cross‑region
  replica (Phase‑2).
- **S3 media**: versioning + lifecycle; (optional) CRR.
- **Typesense**: daily snapshot + outbox replay tool
  *ops/scripts/typesense_rebuild.ts*.
- **Infra as Code**: CDK stacks recreate edge/API.

**N.3 DR steps (one‑pager)**

5347. Declare incident & freeze writes (feature flag).
5348. Restore Aurora to PITR timestamp or promote replica; switch
      secrets/endpoint.
5349. Restore Typesense from snapshot → replay outbox since snapshot.
5350. Smoke tests: login, search, checkout.
5351. Lift write freeze; monitor SLO dashboards.

**N.4 Tests & cadence**

- Quarterly DR drill; timed to targets; postmortem actions tracked.
- Snapshot integrity weekly; alert on failures.

**N.5 Acceptance**

- Last drill met all targets; runbooks current; staff on‑call trained.

## **Appendix O --- Data Governance (Retention, Classification, Masking, Lineage) (paste‑ready)**

**Purpose.** Control data lifecycle, minimize PII exposure, and document
lineage across app → search → analytics.

**O.1 Classification**

- **PII‑S** (sensitive): payout data, government IDs, exact addresses.
- **PII‑B** (basic): names, emails, phones.
- **PUB**: public profiles, reviews (after moderation).
- Registry file: *data/governance/catalog.yaml* (table→fields→class).

**O.2 Retention** *(tune to counsel)*

- Orders/ledger/payouts: **7y**;
- Messages: **24m**, unless legal hold;
- Media originals: retained for owner; SFW variants while published;
  purge on DSAR;
- Analytics: **18m** raw then aggregated;
- Logs: **30--90d** hot → Glacier **12m**.

**O.3 Masking**

- Stage/dev use **synthetic data**; no real PII. Mask functions for
  common fields (*email_hash()*, *phone_mask()*).

**O.4 Lineage & propagation**

- DSAR delete cascades from app → search (≤ 5m) → analytics (next
  nightly).
- Data map in *data/lineage/lineage.md* (arrows, producers/consumers,
  schedules).

**O.5 Acceptance**

- Automated jobs enforce retention; Stage contains no live PII; DSAR
  propagation verified monthly.

## **Appendix P --- Requirements Traceability Matr