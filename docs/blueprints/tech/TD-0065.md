<!-- id: TD-0065 | source: ProjectPlans\TechnicalDevelopmentPlan.odt | range: 234000-238000 -->

 runbook & drill scripts; snapshot retention; restore
  tests.

## **1.12.R Acceptance criteria (mark §1.12 FINAL only when ALL true)**

1246. **Amplify Gen 2** stacks synth and deploy cleanly; CI fails any PR
      that introduces Classic artifacts.
1247. **Three environments** live with separate accounts, DNS, certs,
      and secrets; branch mapping works; previews auto‑expire.
1248. **Security**: WAF enabled, IAM least‑priv, KMS on RDS/DDB/S3, no
      public RDS, TLS enforced, Secrets Manager used.
1249. **Data**: Aurora + Dynamo tables created; backups & retention
      policies; migrations framework in place.
1250. **Observability**: dashboards/alerts deployed; traces flow
      end‑to‑end; PII scrubbing verified.
1251. **Cost**: budgets & alarms active; lifecycle policies in place;
      OCU/ACU/RCU caps; NAT egress minimal.
1252. **DR**: PITR validated; restore drill passes in stage within RTO.
1253. **DX**: local mocks, seed data, and codegen working; CI green;
      cost‑diff gate functional.

## **1.12.S Test matrix (CI + stage drills)**

**Infra correctness**

- CDK diff minimal; no drift; destroy/redeploy dev env passes.

**Security**

- Pen test on WAF rules; IAM analyzer finds no broad permissions;
  secrets never logged.

**Data & migrations**

- Forward/backward migrations with online safety; PITR restore verifies
  data integrity.

**Observability**

- Synthetic transactions visible across traces; alarms fire on injected
  faults.

**Cost**

- Synthetic traffic holds within budget; lifecycle transitions verified;
  search engine OCU alarms quiet.

**DR drill**

- Simulated region issue → restore from snapshot in stage → app healthy
  within RTO.

# **§1.13 --- Data Platform, Analytics & Experimentation**

*(event contracts · ELT (Bronze/Silver/Gold) · near‑real‑time ops views
· product analytics · experimentation · data quality & privacy · BI &
dashboards · cost controls · tests)*

**Purpose.** Build a privacy‑safe, cost‑conscious analytics stack that
powers product decisions, operational visibility (SLOs, reconciliation
health), finance reporting, and experimentation---without
re‑platforming. This section defines the **event model**, **pipelines**,
**storage/layout**, **transformations**, **governance & privacy**,
**BI**, **experimentation**, **SLOs & cost**, **admin tools**, and a
**full test plan**. We do **not** move on until §1.13 meets your 99.9%
bar.

## **1.13.A Canon & invariants**

1260. **Single event canon.** Every user/system action emits an
      immutable, versioned event to a central bus with stable keys
      (*user_id*, *anon_id*, *lbg_id*, *leg_id*, etc.).

1261. Bronze → Silver → Gold.

      u.  **Bronze**: raw, append‑only JSON in S3 (immutable).
      v.  **Silver**: curated, typed Parquet tables (facts/dimensions).
      w.  **Gold**: business‑ready marts (dashboards/KPIs).

1262. **Privacy‑by‑design.** No raw PII (email/phone/images) in events
      or indexes. Emails/phones appear only as **stable hashes** where
      needed for dedupe.

1263. **Money correctness.** Finance facts derive from source‑of‑record
      tables in Aurora (§§1.3, 1.9) and from Stripe/tax webhooks; checks
      ensure sums reconcile (ties into daily close gates).

1264. **Cost‑efficient first.** S3 + Glue Catalog + **Athena** for
      querying; **QuickSight SPICE** or **Metabase** for BI; optional
      **Redshift Serverless** only when we outgrow Athena latency.

1265. **Experimentation guardrails.** Sticky bucketing, exposure
      logging, predefined guardrails (refund/complaint ceilings), and
      sequential/CUPED‑ready metrics.

## **1.13.B High‑level architecture**

- Ingestion (near real‑time):

  - App & web clients send event envelopes to an authenticated
    **/collect** endpoint (AppSync → Lambda).
  - Backend services publish **domain events** (the ones we enumerated
    across §§1.3--1.12) to **EventBridge**.
  - External providers (Stripe, e‑sign, SES) → webhook ingesters →
    normalized eve