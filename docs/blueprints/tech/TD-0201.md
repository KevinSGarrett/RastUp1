<!-- id: TD-0201 | source: ProjectPlans\TechnicalDevelopmentPlan.odt | range: 723600-727600 -->

 **Agent C --- Delivery & Compliance**: SES/Pinpoint integration, DNS,
  bounce/complaint handlers.
- **Agent D --- Digests & Quiet**: digest builder, timezone scheduling,
  Quiet‑Hour logic & exceptions.

## **1.10.15 Test plan**

3276. **Preferences**: toggle per‑event/channel; verify optional sends
      suppressed; required‑service still deliver.
3277. **Quiet Hours**: optional messages delayed; exceptions (booking
      reminders, reschedule expiring, payment/payout failure, safety)
      deliver immediately or as configured.

NonTechBlueprint

3278. **Routing**: booking confirmed/rescheduled triggers correct
      templates to buyer & provider; Action Cards generate correct
      approvals/reschedule notices.

NonTechBlueprint

3279. **Digests**: daily/weekly contain correct sections; "Booking day"
      bypass; de‑dup works.

NonTechBlueprint

3280. **Deliverability**: bounces/complaints create suppression entries;
      subsequent sends are blocked; in‑app banner shows.
3281. **Idempotency & rate limits**: duplicate events do not re‑send;
      optional floods throttled.
3282. **Push tokens**: invalid tokens cleaned; per‑device opt‑out
      honored.
3283. **Security**: no PII or NSFW previews leak; deep links require
      auth and respect Safe‑Mode.

NonTechBlueprint

## **1.10.16 Acceptance criteria --- mark §1.10 FINAL only when ALL true**

3284. Users can manage **per‑event, per‑channel** preferences and
      **Quiet Hours**, including exceptions; changes persist and gate
      sends.

NonTechBlueprint

3285. The orchestrator consumes product events (messages, requests,
      approvals, reschedules, disputes, payments, payouts, uploads) and
      dispatches **email/push/in‑app** using active templates.

NonTechBlueprint

3286. **Transactional** messages always deliver; optional messages
      respect prefs/Quiet Hours/digests.
3287. **ICS export** included for booking emails; reschedules update
      ICS.

NonTechBlueprint

3288. **Deliverability** ready: SPF/DKIM/DMARC configured;
      bounce/complaint suppression active; warmup plan executed.
3289. **Consent ledger** immutable and queryable; unsubscribe functions
      correctly; marketing remains OFF at MVP.
3290. **Observability** dashboards/alerts live; costs remain within plan
      (serverless, pay‑as‑you‑go).

# **§1.11 --- Media & File Pipeline (Uploads, Processing, Delivery, Proofs & Deliverables) --- Full Technical Spec**

**Purpose.** Provide a secure, cost‑efficient pipeline for **images,
video, audio, PDFs** and **in‑thread attachments** used across:
profiles/portfolios, Service Profiles, messaging & **Action Cards**
(proofs/approvals, expenses), booking deliverables, and admin evidence.
Enforce **Safe‑Mode SFW** on public surfaces, watermark & expiry for
**Proofs**, virus‑scan everything, and keep costs elastic from **build →
launch → growth**.

## **1.11.1 Scope → Technical**

- **Ingestion:** direct‑to‑S3 presigned uploads (browser/mobile),
  resumable for large files, type/size validation, AV scan,
  EXIF/metadata extraction.
- **Processing:** image resize/crop/encode (WebP/AVIF + JPEG fallback),
  video transcode (HLS + MP4 fallback), thumbnails, watermarks, metadata
  tags, **NSFW/Safe‑Mode classification**.
- **Delivery:** CloudFront CDN with signed URLs, cache policies, range
  requests, hotlink protection.
- **Product hooks:** Profiles & SPs (§1.7), Messaging/Action Cards
  (§1.4), Booking Deliverables (§1.3), Reviews media (§1.9), Admin
  evidence (§1.5).
- **Policies:** Safe‑Mode defaults (public SFW only), proof galleries
  (watermarked, expiring), deliverable bundles (licensed,
  non‑watermarked), retention & legal hold.
- **Cost posture:** lifecycle to S3‑IA/Glacier, adaptive transcode
  ladder, dedupe, quotas, and throttles.

## **1.11.2 Architecture (Amplify Gen‑2 posture)**

- **Frontend**:

  - Web (Next.js): Uploader component with chunk/resume, client crop,
    progress, and preflight checks (type/size).
  - Mobile (React Native