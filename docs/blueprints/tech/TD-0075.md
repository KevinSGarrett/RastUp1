<!-- id: TD-0075 | source: ProjectPlans\TechnicalDevelopmentPlan.odt | range: 270000-274000 -->

fix
    schema or add adapter transform.

## **1.13.L/M/N/O (expanded) --- Error Taxonomy, SLOs, Tests, Work Packages**

### **L. Error codes (operational)**

- *EVENT_SCHEMA_INVALID*, *EVENT_ENVELOPE_INVALID*, *EVENT_PUT_FAILED*,
- *PIPELINE_LAG_EXCEEDED*, *CTAS_FAILURE*, *QUALITY_CHECK_FAILED*,
- *ATHENA_SCANNED_BYTES_BREACH*, *BI_REFRESH_FAILED*, *DSAR_CONFLICT*.

Each emits a **CloudWatch metric** with labels (*env*, *component*,
*severity*) and raises an alarm with runbook link.

### **M. SLOs & Alerts (detail)**

- **Ingestion p95** ≤ 60 s; Alarm at 120 s for 10 min.
- **NRT views** ≤ 10 min; Alarm at 20 min.
- **Daily marts** done by 06:00 local; Alarm at 07:00.
- **Athena scanned bytes**: \< 500 GB/day (stage), \< 2 TB/day (prod) to
  start; alarms at 80%.
- **BI refresh** success ≥ 99%; alarm on 2 consecutive failures.

### **N. Test matrix (concrete add‑ons)**

- **Contract tests**: CI job enumerates all */schemas/\*.json* and
  validates synthetic fixtures; fails PR on mismatch.
- **Drill tests**: load a synthetic day, produce Silver/Gold, assert
  KPIs match golden JSON.
- **Lag tests**: inject 10k events/min for 15 min; verify NRT views
  within 10 min.
- **DSAR tests**: create user, produce events, issue tombstone, verify
  exclusion in Silver/Gold, verify Bronze exclusion view.
- **Cost tests**: run representative dashboard queries; ensure scanned
  bytes under thresholds.

### **O. Work packages (ready to assign to your 4 Cursor agents)**

- Agent C --- Ingestion & Schemas

  - WP‑DATA‑ING‑01: EventBridge bus + Firehose + transform Lambda
    (dynamic partitions).
  - WP‑DATA‑ING‑02: Envelope & event JSON Schemas + ajv validator
    Lambda.
  - WP‑DATA‑ING‑03: Provider webhook normalizers → EventBridge.

- Agent B --- Modeling & Quality

  - WP‑DATA‑MOD‑01: Bronze table, CTAS for *fact_search_impressions*,
    *fact_promotions_events*, *fact_booking_legs*.
  - WP‑DATA‑QTY‑01: Great Expectations suites + alerts; dbt tests.

- Agent A --- BI & Experiments

  - WP‑DATA‑BI‑01: QuickSight datasets & dashboards
    (Executive/Operations/Growth/Trust).
  - WP‑EXP‑01: Assignment function, *dim_exposure*, guardrails metrics,
    CUPED pipeline.

- Agent D --- Governance & Ops

  - WP‑DATA‑GOV‑01: Lake Formation permissions & LF tags; DSAR tombstone
    job.
  - WP‑DATA‑OPS‑01: NRT CTAS jobs + payout backlog view; backfill
    runner; cost monitors.

## **1.13.P (re‑stated) --- Final Acceptance Checklist for §1.13**

1423. **Ingestion** to Bronze S3 via EventBridge→Firehose with dynamic
      partitions; schema validation live; p95 lag ≤ 60 s.
1424. **Silver** facts and **Gold** marts materialize with dbt/CTAS;
      tests pass; NRT ops views update ≤ 10 min.
1425. **Experimentation** runs (assignment, exposure, metrics with
      guardrails and CUPED).
1426. **Privacy & governance**: no PII in events; LF column/row
      permissions; DSAR tombstone flow proven; legal holds respected.
1427. **BI**: QuickSight dashboards up, SPICE refreshed; RLS applied
      where required.
1428. **Cost & SLOs**: scanned bytes, DPU‑hours, SPICE capacity within
      budgets; alarms & runbooks configured.
1429. **Runbooks**: backfills, schema breaks, lag, high spend all
      documented and tested.

# **§1.14 --- Fan‑Sub (Paid Content, Requests, Tips & PPV)**

*(roles & gating · subscriptions · paid requests & deliverables · tips &
PPV · media pipeline (previews vs finals, watermarking) · safety &
age‑gates · payments, taxes & receipts · moderation & DMCA · dashboards
· admin · telemetry · tests · cost)*

**Purpose.** Implement a **Fan‑Sub** system that lets fans support
creators (talent) via **subscriptions**, **paid custom requests**,
**tips**, and **pay‑per‑view (PPV)** content---while enforcing **18+
verification**, safe‑mode rules, privacy, and cost efficiency. Fan‑Sub
integrates with messaging (§1.4), docs/e‑sign where required (§1.5),
trust gates (§1.6), payments & statements (§1.9), comms (§1.10), studios
(§1.11 when relevant), an