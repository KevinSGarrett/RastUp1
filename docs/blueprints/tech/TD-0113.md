<!-- id: TD-0113 | source: ProjectPlans\TechnicalDevelopmentPlan.odt | range: 406800-410800 -->

 CodeQL (or equivalent) on PR; custom regex rules for
  secrets.
- **Secrets scanning**: pre‑receive hooks + CI step; block merges on
  positive.
- **Container/Lambda layers**: ECR image scan or *npm audit* gates;
  Lambda base runtime kept current.
- **IaC**: CDK/Terraform scanned with **Checkov**/cfn‑nag.
- **CI**: OIDC‑based deploy roles (no long‑lived keys); branch
  protections; required reviews; signed tags for releases.
- **SBOM**: generate CycloneDX on release; archive to S3.

**Inline artifact --- CI policy checklist**\
**Path:** *security/ci/policy.md*

*- Require PR reviews (2 for prod)*\
*- Status checks: build, test, lint, SAST, IaC scan, license scan*\
*- Protected branches: no force-push, linear history*\
*- OIDC deploy to AWS; no PAT/keys stored*\
*- Secrets only in GitHub OIDC to AWS + Secrets Manager at runtime*\

## **1.18.J Incident response (IR) & disaster recovery (DR)**

- **IR team & runbooks**: security@ group, Slack #secur‑incidents
  (private), paging via SNS.

- **Playbooks**: credential leak, PII exposure, DDOS, data corruption,
  provider breach.

- **Forensics**: isolate role credentials; retrieve CloudTrail & app
  logs; snapshot affected S3 prefixes with Write Once retention.

- **DR**:

  - **Backups**: Aurora PITR, daily snapshots; Dynamo PITR; S3
    versioning + Object Lock for evidence.
  - **RPO/RTO**: core web ≤ 15m RPO / ≤ 60m RTO; payments webhooks ≤ 5m
    / 15m.
  - **Regional**: consider cross‑region S3 replication for evidence
    vault; Aurora global DB if required later.

**Inline artifact --- IR ticket template**\
**Path:** *security/ir/ticket-template.md*

*- Summary:*\
*- Detected by:*\
*- Impacted data/classes:*\
*- Timeline:*\
*- Containment:*\
*- Eradication:*\
*- Recovery:*\
*- Customer comms needed? Y/N*\
*- Follow-up CAPA items:*\

## **1.18.K Compliance scaffolding (SOC 2‑ready baseline)**

- **Policies**: access control, change mgmt, incident response, vendor
  risk, data retention, acceptable use (templates in
  */security/policies/\**).
- **Evidence**: automated exports (CloudTrail sampling, IAM user/role
  diffs, Security Hub findings, backup status, vulnerability scans).
- **Vendor management**: Stripe/IDV/esign risk rating, DPAs stored;
  review annually.
- **Training**: annual security awareness for staff;
  onboarding/offboarding checklist.

## **1.18.L Monitoring & detection**

- **GuardDuty**: enabled in all accounts; alerts → Security account SNS.

- **Security Hub**: aggregates findings; CIS benchmark checks.

- **Access Analyzer**: detect public/broad‑trust resources.

- **CloudWatch/SNS** alerts:

  - WAF blocks spike, 4xx/5xx spikes, AppSync throttles, Lambda DLQ
    growth, KMS key errors, Secrets rotation failure.

- **SIEM (lightweight)**: centralize key logs in S3 + Athena queries;
  optional OpenSearch later.

## **1.18.M SLOs, budgets & costs**

**SLOs**

- **Auth availability** ≥ 99.9% monthly.
- **Webhook idempotency** 100% (no double side‑effects).
- **P0 IR response** ≤ 15 min; **P1** ≤ 1 hour.
- **Secrets rotation** success 100% monthly cadence.

**Budgets**

- WAF: managed rules only at start; add Bot Control if abuse appears.
- Security Hub/GuardDuty: monitor costs; scope to prod + stage at
  launch.
- Logs: 30--90d hot retention; archive to Glacier Instant Retrieval
  thereafter.

## **1.18.N Test plan (security)**

1978. **AuthZ tests**: attempts to access other users' resources denied;
      \@auth rules covered.
1979. **Webhook replay**: replay Stripe/IDV webhooks; verify idempotent
      outcomes.
1980. **Secrets rotation**: rotate Stripe/SES/... in stage; production
      dry‑run window; alarms on failures.
1981. **WAF**: simulate bursts; ensure rate rules and managed sets
      engage; false positives monitored.
1982. **SAST/IaC**: seed a vulnerable branch; CI blocks merge.
1983. **DR**: restore Aurora snapshot into a staging clone; validate
      integrity.
1984. **PII logging**: send synthetic PII; verify logs redaction and
      ale