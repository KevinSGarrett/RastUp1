<!-- id: TD-0068 | source: ProjectPlans\TechnicalDevelopmentPlan.odt | range: 244800-248800 -->

 **1.13.H Privacy, governance & retention**

- **Lake Formation** for table/column permissions; analysts get
  **row‑level filtering** by environment and city if required.

- **Hashing**: *email_sha256*, *phone_sha256* kept only in **Silver
  private** area (not in Gold); never in events.

- **DSAR/Deletion**: user deletion writes a **tombstone event**; nightly
  job purges Silver/Gold joins that carry the user's PII hash; Bronze
  (raw, immutable) is handled by maintaining a mapping table of
  redactions and excluding on read.

- **Retention**:

  - Bronze events: 18 months (partition delete after).
  - Silver facts: 24--36 months depending on table.
  - Gold marts: rolling 24 months.

- **Legal holds**: tag partitions; purge blocked until hold cleared.

## **1.13.I BI & dashboards**

- **QuickSight** workspaces per function: **Executive**, **City Ops**,
  **Trust**, **Finance**, **Support**, **Growth**.
- Use **SPICE** extracts for fast loads; refresh cadences (NRT where
  appropriate, otherwise daily).
- **Metabase** (optional) for self‑serve exploration; connects to
  Athena; row‑level guards via Lake Formation.

**Core dashboards** (initial)

- **Executive**: GMV, take rate, bookings, CAC/LTV (when available),
  city trends, SLO tiles.
- **Operations**: payout backlog, recon variance, cancellation/refund
  bands, dispute queue.
- **Trust**: IDV/BG funnels, risk bucket movement, dispute outcomes.
- **Growth/Promotions**: impressions/clicks/invalid rate, CPA proxy,
  campaign pacing.
- **Comms**: delivery vs bounce/complaints, digest suppression, opt‑out
  flow.
- **Studios**: verification rate, amenity usage, quote success %.

## **1.13.J Cost posture & performance**

- **S3**: Parquet + Snappy compression; partition by date (and city when
  cardinality helps); lifecycle after 90--180 days to colder storage.
- **Athena**: avoid scanning whole buckets---push **partition filters**;
  ctables store sorted small files for today's partitions; limit CTAS
  output file sizes (256--512 MB).
- **Glue**: small DPU reservations; scale jobs by schedule; stop on
  idle; reuse code across models.
- **QuickSight**: prefer SPICE extracts (charged per user/capacity) with
  scheduled refresh; keep visuals focused.
- **Redshift Serverless**: disabled at launch; enable behind a flag if
  Athena latency becomes a blocker; start at smallest RPU with pause
  when idle.

## **1.13.K Admin tooling**

- **Schema registry** web UI (read‑only) listing events & versions with
  examples.
- **Backfill runner** for late events (replay a partition/day without
  clobbering existing Parquet).
- **Data dictionary** (Gold) with KPI definitions and SQL behind each
  card (single source of truth).
- **Access audit**: who queried which tables/partitions (CloudTrail/Lake
  Formation).

## **1.13.L Error taxonomy (data platform)**

- *EVENT_SCHEMA_INVALID* --- payload fails JSON Schema.
- *EVENT_REJECTED_RATE_LIMIT* --- client flooding; sample/delay.
- *PIPELINE_LAG_EXCEEDED* --- Bronze→Silver lag \> SLO.
- *QUALITY_CHECK_FAILED* --- Great Expectations failed (which check &
  partition).
- *DSAR_CONFLICT* --- deletion collides with legal hold.
- *BI_REFRESH_FAILED* --- SPICE refresh failed.

## **1.13.M SLOs & alerts**

- **Ingestion**: EventBridge→S3 (Bronze) **≤ 60 s p95**.
- **NRT views**: Bronze→Silver (ops views) **≤ 10 min p95**.
- **Daily marts**: complete by **T+6h** local.
- **BI**: Dashboards available by **08:00** local; SPICE refresh success
  **≥ 99%** rolling 7 days.

Alerts on: ingestion lag beyond SLO, quality failures, unusual GMV
deltas, ATHENA_SCANNED_BYTES anomalies (cost), QuickSight refresh
failures.

## **1.13.N Test plan (CI + stage)**

**Contracts & ingestion**

1347. Validate JSON Schemas for all events; generate fixtures; reject
      malformed example.
1348. Simulate Firehose → S3 path; partitions and Glue catalog creation
      verified.

**Transforms**\
3) Build Silver facts with sample events; ensure referential integrity;
Great Expe