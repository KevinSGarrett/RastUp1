<!-- id: TD-0321 | source: ProjectPlans\TechnicalDevelopmentPlan.odt | range: 1155600-1159600 -->

              Account takeover           Device fingerprint; email verify; step‑up MFA on payout/edit                  New‑device + geo‑velocity events                    Session revoke; password reset; notify user                   Security/Support
  **U‑03**   Profiles/Media     NSFW leak on public        S3 originals private; SFW‑only variants; Safe‑Mode filters everywhere         "Public render with NSFW \> 0" sentinel             Immediate deindex from Typesense; purge cache; strike media   Safety
  **U‑04**   Messaging          Spam/solicitation bypass   Per‑dyad QPS; keyword redaction; new‑user probation                           Spam classifiers; user reports; high QPS detector   Shadow‑limit, mute, or suspend per strike ladder              Trust & Safety
  **U‑05**   Search             Scraping / query spam      WAF rate‑limit; API keys for partners; suggestions hard cap                   Zero‑result spikes; IP entropy; UA mix              Soft CAPTCHA; temp block subnet                               Security
  **U‑06**   Search             Ranking gaming             Edit‑rate clamp; verified boost only after KYC; min reviews gating            Rank‑drift monitors by cohort                       Reduce weight; manual review queue                            Product/Safety
  **U‑07**   Booking/Payments   Chargeback farming         Refund kernel transparency; velocity limits; step‑up MFA for payout           CB ratio by cohort; disputed order patterns         Claw back referral; suspend payouts; evidence packs           Payments
  **U‑08**   Webhooks/API       Replay/forgery             HMAC signatures; timestamp window; idempotency keys                           Signature failure rate                              Quarantine + DLQ; rotate secret                               Platform
  **U‑09**   Admin              IDOR / privilege abuse     RBAC; row‑level checks; dual‑control for destructive ops                      WORM audit + anomaly                                Immediate session kill; break‑glass log                       Security
  **U‑10**   Platform           Data exfil/log PII         Log redaction; zero PII in debug; scoped IAM                                  PII scanners; S3 Access logs                        Rotate creds; redact & re‑ingest                              Platform
  **U‑11**   Availability       DoS/burst                  WAF rate policies; Leaky bucket in API; cache hot queries                     p95 latency; 5XX spikes; queue depth                Scale up; shed load; degrade non‑critical                     SRE
  **U‑12**   Compliance         DSAR gaps                  Consent logs; delete/export pipelines                                         DSAR SLA timers                                     Escalation to privacy officer                                 Privacy
  ---------- ------------------ -------------------------- ----------------------------------------------------------------------------- --------------------------------------------------- ------------------------------------------------------------- ------------------

**Acceptance of matrix:** Each item has at least one **Prevent, Detect,
Respond** mapped to a **test** and **alert** (see U.7, U.9).

## **U.2 Event & Feature Schemas (Abuse store)**

**DynamoDB tables (serverless, low‑cost):**

- ***abuse_events*** *(PK: entity#\<type\>#\<id\>, SK: ISO ts, TTL
  180d)*\
  Fields: *entity_type (user\|ip\|device\|email\|dyad\|media\|order)*,
  *event_type*, *value*, *ctx {ip, asn, ua, geo}*, *score_delta*,
  *trace_id*.
- ***abuse_entities*** *(PK: entity#\<type\>#\<id\>)*\
  Fields: *score*, *strikes {spam:int, nsfw:int, chargeback:int, ...}*,
  *status (ok\|shadow\|mute\|suspend)*, *notes*, *updated_at*.
- ***abuse_actions*** *(PK: action#\<id\>)*\
  Fields: *entity_ref*, *action (warn\|shadow\|mute\|suspend\|restore)*,
  *reason*, *actor (system\|staff)*, *expires_at*, *created_at*.

**Aurora (for joins/analytics):** mirrored v