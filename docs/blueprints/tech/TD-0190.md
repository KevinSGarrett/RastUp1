<!-- id: TD-0190 | source: ProjectPlans\TechnicalDevelopmentPlan.odt | range: 684000-688000 -->

ons & digests**

- Nudges during onboarding: "Add your first package", "Complete
  availability", "Verify ID to unlock payouts/IB".
- Weekly digest: "Your profile completeness is X%," "Add a case study,"
  "Enable IB to appear in Instant Book filter."

## **1.7.11 Observability, KPIs & cost**

- **Events**: *onboarding.step.view\|complete*, *sp.create\|publish*,
  *asset.upload\|blocked*, *completeness.changed*.
- **KPIs**: TTFP (time to first publish), % publish within 7 days, avg
  completeness at publish, IB eligibility rate, avg package price,
  search impressions → booking CTR for new SPs.
- **Cost**: images (S3 + transforms) cached; Aurora Serverless v2 small
  floor; Typesense small cluster. No third‑party profile CMS.

## **1.7.12 Work packages (Cursor 4‑agent lanes)**

- **Agent A --- Data/API**: migrations, GraphQL resolvers, completeness
  engine, publish guards, events.
- **Agent B --- UI/UX**: onboarding wizard, profile/SP editors, asset
  cropper, previews, SEO hints.
- **Agent C --- Pricing & Licensing**: package/extra/licensing
  calculators, travel pricing, server validators.
- **Agent D --- Search/SEO & Nudges**: Typesense ingestion, ISR hooks,
  JSON‑LD helpers, onboarding nudges.

## **1.7.13 Test plan**

3105. **Onboarding happy path**: role select → basics → photos (SFW) →
      package/extras/license → availability → publish; profile appears
      in search.
3106. **Guards**: try publish with missing avatar/availability/package →
      blocked with actionable errors.
3107. **Safe‑Mode**: upload NSFW avatar/cover → blocked; SFW
      replacements pass; public surfaces remain SFW.
3108. **Pricing**: license multiplier vs fixed adder; travel fee
      computed with free radius; server validation rejects tampered
      totals.
3109. **IB unlock**: IB toggle disabled until **IDV PASSED**; after IDV,
      toggle enabled and appears in search filters.
3110. **SEO**: JSON‑LD Person valid; noindex before publish; canonical
      after.
3111. **Search**: new SP indexed with correct facets; completeness below
      60 hidden; above 80 shown/ranked.

## **1.7.14 Artifacts (paste‑ready)**

- *db/migrations/017_profile_core.sql* --- DDL above.
- *api/schema/profile.graphql* --- queries & mutations above.
- *web/app/(dashboard)/onboarding/\** --- step components.
- *web/seo/jsonld-person.tsx* --- helper (ties to §1.27 pattern).
- *web/components/PackageBuilder.tsx*, *ExtraBuilder.tsx*,
  *AvailabilityEditor.tsx*.
- *jobs/search/people-ingest.ts* --- Typesense ingestion workers.
- *observability/dashboards/onboarding.md* --- KPI queries & chart
  definitions.

## **1.7.15 Acceptance criteria --- mark §1.7 FINAL only when ALL true**

3119. A new provider can complete onboarding and **publish** at least
      one **Service Profile** with valid **packages, availability, and
      pricing**.
3120. **IDV gate** enforces payouts/IB unlocks; IB toggle appears only
      after IDV passes.
3121. Public profile & SP surfaces are **SFW** under Safe‑Mode; NSFW
      assets are blocked or blurred and prevent publish.
3122. Search/SEO integrate: JSON‑LD Person, ISR refresh, Typesense index
      populated on publish; profiles below completeness threshold do not
      surface.
3123. Pricing rules (license, travel, extras) are server‑validated and
      consistent with checkout in §1.3.
3124. All events, KPIs, and costs match launch posture; no reliance on
      third‑party CMS.

## **Gate for the current subsection (your rule)**

We closed **§1.7 --- Accounts, Profiles & Provider Onboarding** at
**≥99.9%** in the previous message. There are no open gaps versus your
non‑technical plan. Per your instruction, I'm proceeding
**sequentially** to **§1.8** and I will **not** move past it until §1.8
also meets the ≥99.9% bar.

# **§1.8 --- Notifications, Email, Push & Communication Preferences --- Full Technical Spec**

**Purpose.** Provide a single, compliant, cost‑efficient system for
**transactional** (e.g., booking confirmed), **behavior