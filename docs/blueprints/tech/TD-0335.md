<!-- id: TD-0335 | source: ProjectPlans\TechnicalDevelopmentPlan.odt | range: 1206000-1210000 -->

* - name: SAST (CodeQL)*\
*uses: github/codeql-action/init@v3*\
*with: { languages: javascript }*\
* - name: CodeQL analyze*\
*uses: github/codeql-action/analyze@v3*\
\
*container-scan:*\
*runs-on: ubuntu-latest*\
*steps:*\
* - uses: actions/checkout@v4*\
* - name: Build Typesense image (if custom)*\
*run: \|*\
*docker build -t rastup/typesense:scan ./search/*\
* - name: Trivy scan*\
*uses:*
[*aquasecurity/trivy-action@0.20.0*](mailto:aquasecurity/trivy-action@0.20.0)
*with:*\
*image-ref: rastup/typesense:scan*\
*vuln-type: \"os,library\"*\
*severity: \"CRITICAL,HIGH\"*\
*ignore-unfixed: true*\
\
*publish-sbom:*\
*needs: \[sca-sast\]*\
*runs-on: ubuntu-latest*\
*if: startsWith(github.ref, \'refs/tags/\')*\
*steps:*\
* - uses: actions/checkout@v4*\
* - name: Upload SBOM artifacts*\
*uses: actions/upload-artifact@v4*\
*with:*\
*name: sbom-\${{ github.sha }}*\
*path: security/sbom/\*.json*\

## **M.5 Dependency-Track (optional but recommended)**

**Use case:** centralized SBOM ingestion with vulnerability lifecycle
tracking.

**GitHub workflow** (*.github/workflows/deptrack-sync.yml*)

*name: deptrack-sync*\
*on:*\
*workflow_dispatch:*\
*push:*\
*tags:*\
* - \'v\*.\*.\*\'*\
*jobs:*\
*push-sbom:*\
*runs-on: ubuntu-latest*\
*steps:*\
* - uses: actions/checkout@v4*\
* - name: Find SBOMs*\
*run: echo \"SBOMS=\$(ls security/sbom/\*.json \| tr \'\\n\' \' \')\"
\>\> \$GITHUB_ENV*\
* - name: Upload to Dependency-Track*\
*if: env.SBOMS != \'\'*\
*run: \|*\
*for f in \$SBOMS; do*\
*curl -s -X POST \"\$DEPTRACK_URL/api/v1/bom\" \\*\
*-H \"X-Api-Key: \$DEPTRACK_API_KEY\" \\*\
*-F \"autoCreate=true\" \\*\
*-F \"projectName=rastup-\$(basename \$f .json)\" \\*\
*-F \"bom=@\$f\"*\
*done*\
*env:*\
*DEPTRACK_URL: \${{ secrets.DEPTRACK_URL }}*\
*DEPTRACK_API_KEY: \${{ secrets.DEPTRACK_API_KEY }}*\

**Policy settings in Dependency-Track:**

- **Violations**: fail policy on GPL/AGPL/SSPL licenses; raise warning
  on MPL/EPL.
- **Findings**: auto-create tickets for Critical/High; SLA clock per
  severities above.

## **M.6 License check (denylist) ---** ***security/policies/license_allowlist.txt***

*MIT*\
*Apache-2.0*\
*BSD-2-Clause*\
*BSD-3-Clause*\
*ISC*\
*CC0-1.0*\

**CI step (optional)**

*npx license-checker \--summary \--onlyAllow=\"\$(tr \'\\n\' \';\' \<
security/policies/license_allowlist.txt)\"*\

## **M.7 Pinned packages ---** ***security/policies/pins.json***

*{*\
*\"jsonwebtoken\": \"\^9.0.2\",*\
*\"argon2\": \"\^0.31.2\",*\
*\"@aws-sdk/\*\": \"\^3.520.0\",*\
*\"apollo-server-core\": \"\^3.13.0\"*\
*}*\

## **M.8 Exception workflow ---** ***security/vuln_exceptions.yaml***

*exceptions:*\
* - id: CVE-2025-12345*\
*package: \"foo-lib\"*\
*version: \"1.2.3\"*\
*severity: HIGH*\
*owner: \"*[*platform@company.com*](mailto:platform@company.com)*\"*\
*expires: \"2026-01-31\"*\
*reason: \"False positive in transitive dep; upstream patch pending\"*\
*compensating_controls:*\
* - \"Feature flag off for vulnerable code path\"*\
* - \"WAF rule denies vector\"*\

## **M.9 Provenance & signing (optional)**

- **OIDCâ†’AWS**: no long-lived credentials; GitHub Actions assumes IAM
  role with limited permissions.
- **Cosign**: sign custom container images and store attestation in
  *security/attestations/*.
- **SLSA**: keep *build_info.json* with commit, runner, toolchain
  versions.

## **M.10 Acceptance (Appendix M = FINAL)**

5691. Every release produces **SBOMs** for *web*, *api*, and any
      **containers**; artifacts stored and attached to releases.
5692. CI fails on **Critical** and **High** vulns (unless time-boxed
      exception exists).
5693. **License** check passes per allowlist; violations block merges.
5694. **Remediation SLAs** are enforced (report shows zero overdue
      Critical/High).
5695. (If enabled) SBOMs are synced to **Dependency-Track**; findings
      create tickets automatically.
5696. Documentation (*security/policies/\*.md*) is present in the repo.

# **Appendix Q --- API Versioning & Change Management (GraphQL, REST & Webh