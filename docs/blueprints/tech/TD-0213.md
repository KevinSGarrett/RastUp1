<!-- id: TD-0213 | source: ProjectPlans\TechnicalDevelopmentPlan.odt | range: 766800-770800 -->

lement**

- If **full capture at booking** (MVP simplest): capture immediately.
- If **escrow / split capture**: authorize at booking (or capture
  deposit) and capture balance **N hours** before start or after
  completion depending on policy.
- Platform fee realization at capture; provider payable moves from
  escrow liability to provider payable.

**D) Receipts & notifications**

- Generate **PDF receipt**; store in S3 (private); send email with
  download link; in‑app receipt available.
- For payouts: display scheduled date, net amount.

## **1.13.6 ACH vs. Cards --- Plaid & Financial Connections**

**Default (MVP): Cards + Apple/Google Pay** via Stripe.\
**ACH option** (recommended progression):

- **Phase‑1 (optional)**: **Plaid** micro‑deposits or instant
  verifications for bank accounts; create ACH **PaymentIntent**.

- **Alternative**: **Stripe Financial Connections** (managed by Stripe,
  simpler integration than Plaid + manual linking).

- **Trade‑offs**:

  - **Plaid**: fine‑grained control and future portability; slightly
    more integration work; separate billing.
  - **Financial Connections**: fastest path within Stripe ecosystem;
    fewer moving parts; vendor lock‑in higher.\
    **Decision** for launch: **start with cards + wallets** only (lowest
    friction & cost at low volumes). Add **Financial Connections** for
    ACH in **Phase‑2** if card fees materially impact margins or target
    users request ACH.

## **1.13.7 Refund policies & automation**

- **Policy snapshot** on Quote defines % refundable vs. non‑refundable
  by time bands (e.g., ≥72h full; 24--72h 50%; \<24h none), role‑aware.
- System determines refund eligibility automatically for
  buyer/provider‑initiated cancels; admin can override with reason code.
- **Partial refunds** allowed (extras removed, time reduced); ledger
  posts reversal lines; Stripe refund created with metadata (order,
  policy reason).
- Notifications trigged (§1.10).

## **1.13.8 Disputes & chargebacks**

- **Webhook listener** for *charge.dispute.\**.
- Auto‑assemble **evidence pack**: order timeline, chat excerpts, Action
  Cards (proofs/approvals), deliverable hashes, policy snapshot,
  location metadata, receipts.
- Upload evidence to Stripe; log **due date** and status; notify
  provider & support.
- Outcome posted back to ledger (win: reversal; loss: expense + fee).
- **Risk controls**: limit last‑minute bookings; require 3DS for
  high‑risk profiles; cap high‑value deposits.

## **1.13.9 Provider payouts (Connect)**

- **Onboarding**: Hosted link URL; store *stripe_acct*; gate payouts on
  **IDV/KYC** completion (§1.5).
- **Schedule**: weekly (MVP), later configurable; **reserves/holds** for
  disputes or high‑risk bookings.
- **Transfers**: On capture, create **Transfer** to connected account
  (net of platform fee, or transfer gross + application fee).
- **Payout status** mirrored to *pay.payout*; failures notify provider
  and support.
- Year‑end **1099‑K** support via Stripe reporting (if thresholds met).

## **1.13.10 Invoicing, receipts & taxes**

- **Stripe Tax** (MVP): compute at quote time; store jurisdictional
  details in *policy_snapshot*.
- **Invoices/receipts**: generate PDF (HTML → PDF Lambda) with line
  items, fees, taxes, last 4, and unique receipt number; expose in app.
- **Future**: adapter interface for Avalara/TaxJar; multi‑currency;
  VAT/GST support (phase gated).

## **1.13.11 Ledger & daily close**

- **Double‑entry** journal writes for captures, refunds, fees, payouts,
  reserves.
- Stripe **webhooks** idempotent handlers: reconcile **PaymentIntents**,
  **Transfers**, **Payouts**, **Refunds**, **Disputes**.
- **Daily close job**: roll up to revenue, liabilities, taxes payable;
  export to data warehouse; integrity checks (sum(lines)=0).

## **1.13.12 Security, privacy & compliance**

- **PCI DSS**: all sensitive card data handled by Stripe elements; we
  never store PANs.
- **PII**: payout details in Stripe; we store only status & IDs