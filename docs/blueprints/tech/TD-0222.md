<!-- id: TD-0222 | source: ProjectPlans\TechnicalDevelopmentPlan.odt | range: 799200-803200 -->

rsioned locking, GraphQL resolvers.
- **Agent B --- Cards Engine**: per‑type validators, lifecycle
  orchestrations, concurrency/exclusion rules, idempotency.
- **Agent C --- Integrations**: Calendar holds/confirm; Payments
  captures/refunds; Media proofs/deliverables; Notifications.
- **Agent D --- UI/UX**: Order page & timeline, Cards modals/forms,
  "Open Actions" strip, admin viewer.

Each with unit tests, integration tests (calendar/pay/media/notify
fakes), dashboards, and rollback plan.

## **1.14.12 Tests (representative)**

3626. **Reschedule**: propose multiple slots → counterpart accepts one →
      **hold→event** conversion; others released; timeline correct.
3627. **Extras**: provider proposes items → buyer accepts → new receipt
      and ledger update; decline path respected.
3628. **Proofs**: gallery submitted → buyer approves subset →
      change‑request loop → final approval → **Deliverables** created.
3629. **Expense**: items + receipts → buyer approves → charge/reflected
      in final settlement; receipts stored.
3630. **Complete**: requires counterpart approval; cannot complete while
      reschedule open.
3631. **Dispute**: opens dispute track; evidence pack generation started
      (§1.13); order transitions blocked appropriately.
3632. **Locks & idempotency**: duplicate clicks do not double‑create
      cards/responses; version check prevents lost updates.
3633. **Notifications/Quiet Hours**: expiring reschedule near start
      triggers exception; optional cards respect Quiet Hours.
3634. **Security**: only participants access the order; NSFW never
      previewed in email/push; redaction leaves audit trail.
3635. **Performance**: p95 \< 1.5s for create/respond; timeline
      pagination efficient.

## **1.14.13 Artifacts (paste‑ready)**

- *db/migrations/022_orders_cards.sql* --- schema above.
- *api/schema/orders.graphql* --- queries/mutations above.
- *services/orders/state.ts* --- state machine & transition guards.
- *services/cards/engine.ts* --- per‑type lifecycle orchestration.
- *services/cards/validators.ts* --- payload validators.
- *services/cards/locks.ts* --- optimistic lock & idempotency helpers.
- *services/cards/notify.ts* --- event→template mapping for §1.10.
- *web/components/OrderTimeline/\** --- UI components.
- *observability/dashboards/orders.md* --- KPIs & alerts spec.
- *ops/runbooks/orders-stuck-cards.md* --- handling stuck/expired cards.

## **1.14.14 Acceptance criteria --- mark §1.14 FINAL only when ALL true**

3646. Orders have authoritative state with auditable **Timeline** and
      **Action Cards** for all mid‑order changes.
3647. Each card type operates end‑to‑end with validations, deadlines,
      responses, notifications, and side effects.
3648. Calendar holds/confirmations, payment captures/refunds,
      proof/deliverable flows, and reviews window triggers integrate
      correctly.
3649. Concurrency/exclusion rules prevent conflicting cards; idempotency
      & optimistic locking prevent duplicates/lost updates.
3650. Safe‑Mode & privacy rules enforced; emails/push contain no NSFW
      previews.
3651. Dashboards and alarms exist; stuck cards are auto‑escalated;
      performance SLOs met.

# **§1.15 --- Support, Disputes & Resolution Center --- Full Technical Development Plan (Single, Copy-Paste Block)**

**Purpose.** Provide one auditable system for **customer support**,
**refunds**, **booking disputes**, **payments issues**, **chargebacks**,
**DMCA**, and **policy-violation reports** --- tightly integrated with
**Messaging (§1.4)**, **Bookings/Payments (§1.3/§1.13)**, **Docs
(§1.26)**, **Trust & Safety (§1.5)**, **Notifications (§1.10)**, and
**Calendar (§1.12)**. Cost-conscious (serverless + SES), privacy-safe,
and SLA-driven.

## **1.15.1 Objectives & invariants**

3652. **Single front door** ("Support Center" & widget) → deflect common
      issues, then open **typed cases**.
3653. **Evidence-first**: stitch messages, deliverables, docs, payments,
      and 