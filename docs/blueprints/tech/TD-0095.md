<!-- id: TD-0095 | source: ProjectPlans\TechnicalDevelopmentPlan.odt | range: 342000-346000 -->

**: Saved Search UI (ANY/ALL builder), Feed with role
  tabs & Verified chip, link‑in‑bio page, sharecard UI.
- **Agent D --- Comms/QA**: MJML templates
  (alerts/digest/book‑again/referrals), SES setup, test automation for
  dedupe and caps.

## **1.16.P Acceptance criteria (mark §1.16 FINAL only when ALL true)**

1756. Saved Searches support ANY/ALL, Safe‑Mode filters, and **≤1/day**
      alerts with 30‑day pause.

NonTechBlueprint

NonTechBlueprint

1757. Weekly City Digest ships, opt‑in/out respected, **SFW only** in
      email.

NonTechBlueprint

NonTechBlueprint

1758. Unified Feed delivers case studies, availability, touring chips,
      verified studio slots, influence posts with role tabs and Verified
      chip; Safe‑Mode enforced.

NonTechBlueprint

1759. Sharecards and link‑in‑bio microsite generate correctly with UTM
      and QR, and conversions are attributable.

NonTechBlueprint

1760. "Book Again" at 7/30/90 runs with prefilled scope; frequency caps
      and opt‑outs enforced.

NonTechBlueprint

1761. Referrals/credits hit qualification rules, enforce monthly
      caps/ID/device/IP rules, and **claw back** on fraud/refund.

NonTechBlueprint

1762. Telemetry, dashboards, budgets, and alarms are live; cost and SLO
      targets met on a 48‑hour synthetic run.

# **§1.16 --- Artifacts (inline, text‑only)**

**How to paste into your doc:** Keep the headings and the "Recommended
filename/path" comments so your team can find each artifact later.

## **1.16‑A. SQL --- Growth & Referrals schema (Aurora PostgreSQL)**

**Recommended filename/path:** *db/migrations/016_growth_referrals.sql*

*\-- 016_growth_referrals.sql*\
*\-- Saved searches (ANY/ALL filters), alert sends, follow graph, feed
posts,*\
*\-- referrals & credits (ledger), with sensible indexes.*\
\
*begin;*\
\
*create table if not exists saved_search (*\
*search_id text primary key, \-- ssv\_\...*\
*user_id text not null, \-- usr\_\...*\
*scope text not null check (scope in (\'people\',\'studios\')),*\
*query_json jsonb not null, \-- normalized ANY/ALL filters*\
*city text not null,*\
*paused_until date,*\
*last_alert_dt date,*\
*created_at timestamptz not null default now(),*\
*updated_at timestamptz not null default now()*\
*);*\
*create index if not exists idx_saved_search_user on
saved_search(user_id);*\
*create index if not exists idx_saved_search_city on
saved_search(city);*\
\
*create table if not exists saved_search_alert (*\
*alert_id text primary key, \-- ssa\_\...*\
*search_id text not null references saved_search(search_id) on delete
cascade,*\
*alert_dt date not null,*\
*match_count int not null,*\
*email_sent boolean not null default false,*\
*inapp_created boolean not null default false,*\
*created_at timestamptz not null default now(),*\
*unique (search_id, alert_dt)*\
*);*\
\
*create table if not exists follow (*\
*follower_user_id text not null, \-- usr\_\...*\
*target_id text not null, \-- usr\_\... \| fsc\_\...*\
*target_kind text not null check (target_kind in
(\'service_profile\',\'fansub_creator\')),*\
*created_at timestamptz not null default now(),*\
*primary key (follower_user_id, target_id, target_kind)*\
*);*\
\
*create table if not exists feed_post (*\
*feed_id text primary key, \-- fdp\_\...*\
*author_id text not null,*\
*role_tags text\[\] not null,*\
*kind text not null check (kind in
(\'case_study\',\'availability\',\'touring\',\'studio_slot\',\'influence\')),*\
*title text not null,*\
*body_md text,*\
*media_preview jsonb not null default \'\[\]\'::jsonb, \-- SFW previews
only*\
*nsfw_band int not null default 0, \-- 0 allow,1 blur,2 block*\
*city text,*\
*verified_chip boolean not null default false,*\
*is_published boolean not null default false,*\
*created_at timestamptz not null default now(),*\
*updated_at timestamptz not null default now()*\
*);*\
*create index if not exists idx_feed_post_pub on feed_post(is_published,
created_at desc);*\
*create index if not exists idx_feed_post_city on feed_post(city);*\
\
*creat