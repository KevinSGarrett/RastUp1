<!-- id: TD-0234 | source: ProjectPlans\TechnicalDevelopmentPlan.odt | range: 842400-846400 -->

path_prefix text primary key,*\
*robots text not null check (robots in
(\'index,follow\',\'noindex,follow\',\'noindex,nofollow\')),*\
*note text,*\
*updated_at timestamptz default now()*\
*);*\
\
*commit;*\

## **1.17.11 Public GraphQL & page APIs (read‑only)**

**Paste‑ready:** ***api/schema/seo.graphql***

*type LandingCopy { city: String!, role: String!, locale: String!,
introMd: String!, bodyMd: String!, faqJson: AWSJSON!, updatedAt:
AWSDateTime! }*\
*type Redirect { fromPath: String!, toPath: String!, reason: String! }*\
\
*type Query {*\
*landingCopy(city: String!, role: String!, locale: String = \"en\"):
LandingCopy!*\
*seoRedirects: \[Redirect!\]!*\
*sitemapChunk(kind: String!, cursor: String): AWSJSON! \# returns list
of URLs + lastmod*\
*}*\

**Use**: Next.js *getStaticProps* pulls *LandingCopy*; ISR revalidates
on updates. Redirects compiled into CloudFront behaviors at deploy.

## **1.17.12 Build, caching & revalidation**

- **ISR revalidate** on: profile publish/unpublish, studio update, case
  study publish, landing copy update, DMCA takedown.
- **On‑demand revalidation** webhooks from Admin console; rate‑limited
  (token).
- CloudFront **cache keys**: *path + accept-language (coarse) +
  device-class*; vary carefully to keep hit‑ratios high.

## **1.17.13 Analytics & measurement**

- **Search Console**: verify domain; submit sitemaps; monitor coverage,
  enhancements, and page experience.
- **Server logs** (Athena): bot vs human traffic; crawl errors; 404s
  from redirect map gaps.
- **KPIs**: non‑brand clicks, CTR on top 100 landings, % pages passing
  CWV (mobile), indexation rate (submitted→indexed), organic→checkout
  conversion.
- **Dashboards**: CWV distribution, 404s, rendering errors, duplicate
  content flags.

## **1.17.14 Security & compliance**

- **Consent** (GDPR/CCPA): marketing tags fire only after consent;
  functional analytics allowed under legitimate interest if applicable.
- **Cloaking**: never serve materially different content to bots vs
  humans; experiments must be server‑side and identical to crawlers.
- **PII**: never embed PII in schema or OG; redact exif; follow DMCA
  decisions fast.

## **1.17.15 Work packages (Cursor --- 4 agents)**

- **Agent A --- Routing & Sitemaps**: implement URL map, robots &
  sitemaps, redirect engine, sitemap API.
- **Agent B --- Programmatic Pages**: LandingCopy schema, ISR build,
  dynamic stats cards, FAQ schema.
- **Agent C --- CWV & Assets**: image pipeline rules, preloads, budgets,
  Lighthouse CI; consented tag loader.
- **Agent D --- Structured Data & Analytics**: JSON‑LD templates, Search
  Console integration, dashboards; revalidation webhooks.

## **1.17.16 Tests (representative)**

3858. **Canonicalization**: city×role without filters has correct
      canonical; filtered pages set *noindex*.
3859. **Sitemaps**: each chunk returns valid URLs; *lastmod* changes on
      revalidation; index file references correct chunks.
3860. **Structured data**: JSON‑LD validates (Rich Results Test) for
      Studios/Services/FAQ; reviews only when thresholds met.
3861. **CWV budgets**: mobile Lighthouse CI passes (LCP, CLS, INP) on
      representative pages.
3862. **Thin content**: city×role page below thresholds renders but sets
      *noindex*.
3863. **DMCA**: takedown flips page to SFW preview or 410 within 10 min.
3864. **Redirects**: old slugs 301 to new; no loops; analytics sees
      consolidated path.
3865. **Privacy**: no PII or NSFW leaks in public/OG/schema.

## **1.17.17 Acceptance criteria --- mark §1.17 FINAL only when ALL true**

3866. All public pages follow the canonical URL scheme, with
      robots/canonical tags correct and sitemaps live.
3867. **Programmatic city×role** pages render with unique copy, stats,
      FAQ schema, and pass thin‑content gate; ISR + revalidation works.
3868. **Structured data** present and valid on Studios, Services, FAQ,
      and breadcrumbs; reviews shown only when SFW and thresholds met.
3869. **Core Web Vi