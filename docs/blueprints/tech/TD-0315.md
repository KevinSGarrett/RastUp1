<!-- id: TD-0315 | source: ProjectPlans\TechnicalDevelopmentPlan.odt | range: 1134000-1138000 -->

ntics\",webhook_signature_retry.spec.ts,Met, NTB-CACHE-001,\"Cache
key matrix (TTL, Vary) for public pages; ISR revalidation
rules.\",\"NonTechBlueprint (consolidated) --- mapped by domain; see
attached DOCX set\",\"Appendix K --- Cache
Matrix\",cache_keys_matrix.spec.ts,Met, NTB-LOG-001,\"JSON log schema
with correlation IDs and PII redaction policy.\",\"NonTechBlueprint
(consolidated) --- mapped by domain; see attached DOCX set\",\"Appendix
L --- Logging & Redaction\",log_schema_redaction.spec.ts,Met,
NTB-SBOM-001,\"SBOM per build, SCA/SAST/container scans, license policy,
SLAs for remediation.\",\"NonTechBlueprint (consolidated) --- mapped by
domain; see attached DOCX set\",\"Appendix M --- SBOM & Dependency
Policy\",sbom_policy_enforcement.spec.ts,Met, NTB-DR-001,\"RTO/RPO
targets and runbooks for Aurora, Typesense, and S3; quarterly
drills.\",\"NonTechBlueprint (consolidated) --- mapped by domain; see
attached DOCX set\",\"Appendix N --- DR Matrix &
Runbooks\",dr_restore_drill.spec.ts,Met, NTB-GOV-001,\"Data
retention/classification/masking/lineage with automated
jobs.\",\"NonTechBlueprint (consolidated) --- mapped by domain; see
attached DOCX set\",\"Appendix O --- Data
Governance\",retention_lineage_jobs.spec.ts,Met,
NTB-RATE-001,\"Rate‑limits/quotas for auth, search, messages, checkout,
and suggestions.\",\"NonTechBlueprint (consolidated) --- mapped by
domain; see attached DOCX set\",\"Appendix R --- Rate Limits &
Quotas\",rate_limit_matrix.spec.ts,Met, NTB-TESTDATA-001,\"Synthetic
seed dataset for Stage/Dev; no live PII in
non‑prod.\",\"NonTechBlueprint (consolidated) --- mapped by domain; see
attached DOCX set\",\"Appendix S --- Test Data
Management\",seed_masking_policy.spec.ts,Met,

# **Appendix U --- Threat Modeling & Abuse Cases (STRIDE + Abuse/Anti‑Circumvention)**

**Purpose.** Identify and mitigate security threats and growth‑abuse
vectors early; prove mitigations by test.

**U.1 Scope**\
Surfaces: Auth, Profiles/Studios, Media, Messaging, Search,
Checkout/Payments, Partner API/Webhooks, Admin.

**U.2 Data‑Flow (text DFD)**

- *Edge (CloudFront/WAF)* → *Web (Next.js)* → *AppSync/GraphQL* →
  *Lambdas* → *Aurora*
- *Upload client* → *S3 pre‑signed PUT* → *Media processor Lambda* → *S3
  (variants)* → *CloudFront*
- *Event outbox (Aurora)* → *Indexer Lambda* → *Typesense*
- *Stripe/Webhooks* → *Webhook handler* → *Orders/Timeline*
- *Admin console* → *Admin APIs* → *WORM audit store*

**U.3 STRIDE risks & mitigations (representative)**

- **S**poofing: credential stuffing → *CAPTCHA after risk, lockout,
  breach‑check, MFA step‑up for payouts.*
- **T**ampering: IDOR on profile/media IDs → *row‑level auth checks,
  signed URLs, never expose S3 keys.*
- **R**epudiation: admin actions → *WORM audit, dual control for
  sensitive ops.*
- **I**nfo disclosure: NSFW leaks → *Safe‑Mode invariant in search & OG;
  originals never public.*
- **D**oS: search spam → *per‑IP/user QPS + leaky bucket; hard limits on
  suggestions.*
- **E**levation: partner API token misuse → *scoped OAuth, HMAC
  webhooks, rotate secrets.*

**U.4 Abuse cases & countermeasures**

- **Message solicitation bypass** (sharing emails) → *keyword
  redaction + strike system; rate‑limit per dyad.*
- **Spam profile creation** → *email verification, risk scoring, manual
  review on velocity spikes.*
- **Search gaming** (keyword stuffing) → *rank clamp on over‑edited
  accounts; quality signals (rating, reviews).*
- **Chargeback farming** → *refund kernel transparency, evidence packs,
  referral clawbacks.*
- **Storage abuse** → *upload caps, virus scan (if enabled), image type
  allow‑list.*

**U.5 Artifacts**

- *security/threat_model.md* (this content)
- *security/abuse_playbook.md* (signals, thresholds, actions)
- *security/controls_matrix.csv* (Threat→Control→Owner→Test)

**U.6 Acceptance**

- Each STRIDE item maps to at least one **control** and **test**.
- Red‑team checklist executed pre‑launch; critical findings remediated.

# **Appendix V --- Per