<!-- id: TD-0241 | source: ProjectPlans\TechnicalDevelopmentPlan.odt | range: 867600-871600 -->

ey, \-- svd\_\...*\
*studio_id text not null references studio.listing(studio_id) on delete
cascade,*\
*kind text not null, \--
utility_bill\|lease\|business_license\|tax\|photo_outside*\
*s3_key text not null,*\
*status text not null default \'submitted\', \--
submitted\|approved\|rejected*\
*reviewer_id text, \-- admin*\
*reviewed_at timestamptz,*\
*note text,*\
*created_at timestamptz default now()*\
*);*\
\
*commit;*\

**Notes**

- We keep **address_secret** separate to gate exact location until
  needed.
- **h3_7** pre‑computed for geo bucketing; search still uses lat/lng
  (§1.18).
- **deposit_kind** allows holds vs actual charges; aligns with Stripe
  Connect flows (§1.13).
- **availability_template/blackout** integrate with §1.12; studios obey
  buffers & open hours.

## **1.19.3 GraphQL (AppSync) --- paste‑ready schema**

Create *api/schema/studio.graphql*:

*enum StudioPublish { DRAFT REVIEW PUBLISHED SUSPENDED }*\
*enum StudioVerify { UNVERIFIED LITE_VERIFIED VERIFIED }*\
*enum DepositKind { AUTHORIZATION_HOLD CHARGE_REFUNDABLE
NONREFUNDABLE_FEE }*\
*enum PriceUnit { HOUR DAY }*\
\
*type Amenity { id: ID!, name: String!, group: String! }*\
*type Addon { id: ID!, name: String!, descriptionMd: String, chargeKind:
String!, amountCents: Int!, taxable: Boolean! }*\
*type Rule { id: ID!, kind: String!, textMd: String! }*\
*type AvailabilityTemplate { id: ID!, dow: Int!, startMin: Int!, endMin:
Int! }*\
*type Blackout { id: ID!, startsAt: AWSDateTime!, endsAt: AWSDateTime!,
reason: String }*\
\
*type Studio {*\
*id: ID!, handle: String!, name: String!, headline: String,
descriptionMd: String!,*\
*publish: StudioPublish!, verify: StudioVerify!, instantBook:
Boolean!,*\
*city: String!, country: String!, neighborhood: String, lat: Float!,
lng: Float!,*\
*sqft: Int, capacity: Int, baseUnit: PriceUnit!, hourlyMin: Int!,
dayRateCents: Int,*\
*minHours: Float!, cleaningFeeCents: Int!, overtimeRatePct: Int!,*\
*bufferBeforeMin: Int!, bufferAfterMin: Int!, depositKind: DepositKind,
depositCents: Int,*\
*insuranceRequired: Boolean!, nsfwBand: Int!, verifiedChip: Boolean!,*\
*ratingsAvg: Float, ratingsCount: Int!,*\
*amenities: \[Amenity!\]!, rules: \[Rule!\]!, addons: \[Addon!\]!,*\
*availability: \[AvailabilityTemplate!\]!, blackouts: \[Blackout!\]!*\
*}*\
\
*input StudioInput {*\
*handle: String!, name: String!, headline: String, descriptionMd:
String!,*\
*city: String!, country: String!, neighborhood: String,*\
*lat: Float!, lng: Float!, sqft: Int, capacity: Int,*\
*baseUnit: PriceUnit = HOUR, hourlyMin: Int!, dayRateCents: Int,*\
*minHours: Float = 2.0, cleaningFeeCents: Int = 0, overtimeRatePct: Int
= 150,*\
*bufferBeforeMin: Int = 30, bufferAfterMin: Int = 30,*\
*depositKind: DepositKind, depositCents: Int, insuranceRequired: Boolean
= false*\
*}*\
\
*type Query {*\
*studioByHandle(handle: String!): Studio*\
*myStudios: \[Studio!\]! \@auth(role: \"owner\")*\
*}*\
\
*type Mutation {*\
*createStudio(input: StudioInput!): ID! \@auth(role: \"owner\")*\
*updateStudio(studioId: ID!, input: StudioInput!): Boolean! \@auth(role:
\"owner\")*\
*setStudioPublish(studioId: ID!, state: StudioPublish!): Boolean!
\@auth(role: \"owner\")*\
*setStudioInstantBook(studioId: ID!, enabled: Boolean!): Boolean!
\@auth(role: \"owner\")*\
\
*addAmenity(name: String!, group: String!): ID! \@auth(role:
\"admin\")*\
*addStudioAmenity(studioId: ID!, amenityId: ID!): Boolean! \@auth(role:
\"owner\")*\
\
*addRule(studioId: ID!, kind: String!, textMd: String!): ID!
\@auth(role: \"owner\")*\
*addAddon(studioId: ID!, name: String!, descriptionMd: String,
chargeKind: String!, amountCents: Int!, taxable: Boolean = true): ID!
\@auth(role: \"owner\")*\
\
*addAvailability(studioId: ID!, dow: Int!, startMin: Int!, endMin:
Int!): ID! \@auth(role: \"owner\")*\
*addBlackout(studioId: ID!, startsAt: AWSDateTime!, endsAt:
AWSDateTime!, reason: String): ID! \@auth(role: \"owner\")*\
\
*submitStudioDoc(studioId: ID!, kind: String!, s3Key: String!): ID!
\@auth(role: \"owner\