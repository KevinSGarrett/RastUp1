<!-- id: TD-0060 | source: ProjectPlans\TechnicalDevelopmentPlan.odt | range: 216000-220000 -->

 Boolean!*\
\
*submitStudioVerification(studioId: ID!, docs: \[Upload!\]!): Boolean!*\
*}*\

**Guards & rules**

- Publish gate: required fields, minimum media, house rules present.
- Verification submission requires owner IDV passed (from §1.6).
- Media upload uses signed S3 URLs; scans run async; blocked images
  don't appear in public.

## **1.11.L Admin console (Studios)**

- **Verification queue**: view submissions, approve/reject/revoke;
  reasons mandatory; immutable audits.
- **City gate**: gate newly published studios by city (on/off switch).
- **Policy editor**: set default cancellation bands; override per
  studio.
- **Amenity taxonomy**: add/rename synonyms and groups (publishes to
  search analyzer).
- **Pricing inspector**: simulate a quote for a date/time to debug owner
  configs.
- **Owner integrity**: show owner trust badges, dispute/late metrics.

## **1.11.M Error taxonomy (client‑safe)**

- *STUDIO_INCOMPLETE* --- cannot publish; missing fields or media.
- *STUDIO_CONFLICT_BUFFER* --- requested time conflicts after
  buffers/cleaning.
- *STUDIO_BLACKOUT* --- requested time falls in blackout.
- *STUDIO_RATE_NOT_FOUND* --- no applicable rate for requested window.
- *STUDIO_VERIFY_REQUIRED* --- action requires verified studio (e.g.,
  promotions).
- *STUDIO_MEDIA_BLOCKED* --- preview blocked by safety rules.

Errors return *code*, *message*, *hint*, and a correlation id.

## **1.11.N Telemetry & lineage**

- studio.create\|update\|publish\|unpublish
- studio.rate.add\|update\|delete
- studio.media.add\|blocked\|delete
- studio.verification.submitted\|approved\|rejected\|revoked
- studio.blackout.add\|delete
- *studio.quote.request\|response* (with amounts)
- Correlate with owner *user_id* and booking *leg_id* where relevant.

Dashboards: verified share by city, quote success rate, conflict rates,
amenity filter usage, conversion.

## **1.11.O Performance & cost**

- **Search**: small *studios_v1* index; cache results for 60--120s;
  availability buckets precomputed daily.
- **Storage**: S3 previews only; lifecycle to Intelligent‑Tiering after
  30 days; delete orphans after 30 days.
- **Compute**: Lambdas for scans/transforms; quote engine runs in BFF
  with memoized rate lookups.
- **Maps/geo**: no heavy polygons at MVP; simple radius; pre‑computed
  city centroids.

## **1.11.P Test plan (CI + sandbox)**

**Onboarding & verification**

1129. Create studio with mandatory fields; cannot publish until media +
      house rules present.
1130. Submit verification; approve → badge appears; reject → reasons
      surfaced; revoke path.

**Pricing & quotes**\
3) Hourly/slot/day quotes across DOW windows; min/max duration rules;
buffers enforced.\
4) Overtime quote appended via amendment flow.\
5) Tax quote correct per city; deposit auth amount surfaced but not
included in GMV.

**Availability & conflicts**\
6) Blackout block; buffer conflicts on adjacent bookings; ICS feed
integrity.

**Search & facets**\
7) Amenity filters; deposit required toggle; verified badge facet;
ranking respects verified + rating.

**Media & safety**\
8) NSFW scan blocks unsafe previews; blur for band=1; ordering
respected.

**Checkout & deposit**\
9) Attach‑in‑flow: atomic confirm (Studio+Talent) succeeds/fails
together.\
10) Deposit claim flow: claim within window; capture or deny; receipts
updated.

**Admin**\
11) Verification audit trail; policy editor; taxonomy updates push to
search analyzer.

**Performance**\
12) Quote engine p95 \< 120 ms; search p95 unchanged with facets; media
upload pipeline cost within limits.

## **1.11.Q Work packages (Cursor 4‑agent lanes)**

- **Agent B --- Domain/API**\
  WP‑STD‑01: SQL migrations (*studio*, *studio_rate*, *studio_policy*,
  *studio_blackout*, *studio_media*, *studio_verification_audit*).\
  WP‑STD‑02: GraphQL resolvers for Studio CRUD, rates, media, blackouts,
  verification.\
  WP‑STD‑03: Quote engine + buffer/conflict checks; ICS feed generator.
- **Agent C --- Integrations**\
  WP‑STD‑I