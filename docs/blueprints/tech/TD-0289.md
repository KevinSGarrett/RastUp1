<!-- id: TD-0289 | source: ProjectPlans\TechnicalDevelopmentPlan.odt | range: 1040400-1044400 -->

 depth" commonly requested by
security, compliance, and SRE reviewers.

## **A1. Threat Model & Abuse Prevention (STRIDE + Fraud/Risk)**

**Objectives.** Enumerate high‑value assets and attack/abuse paths; map
mitigations to tests and alerts.

**Assets & risks (representative):**

- **Payments & payouts** → card testing, synthetic refunds, account
  takeovers, payout hijack.
- **User content/media** → NSFW leakage to public, copyright violations,
  malicious files.
- **Identity & auth** → credential stuffing, session fixation, MFA
  bypass, OAuth misuse.
- **Search & SEO** → spam/SEO poisoning, scraping, query abuse.
- **Messaging** → harassment, doxxing attempts, off‑platform
  solicitations.

**Controls (high‑impact):**

- **Auth**: rate limits & risk‑based CAPTCHA after failures; password
  breach‑check; MFA step‑up for payout, IB, and IDV actions; session
  rotation on privilege gain.
- **Payments**: Stripe Radar rules; 3DS/SCA where applicable;
  idempotency keys; payout‑dest change requires MFA; negative
  balance/payout holds on risk flags.
- **Media**: size/type magic‑number check; server‑side AV scan (Lambda
  ext); EXIF strip; Safe‑Mode gate for all public fetches; DMCA takedown
  macro.
- **Search**: per‑IP/User QPS limits; suggestion endpoint stricter;
  bot/WAF rules for scraping bursts.
- **Messaging**: rate limits per dyad; link/phone/email redaction in
  public messages; block/abuse report actions; auto‑mute on repeated
  flags.

**Tests & alerts.**

- Seeded credential‑stuffing burst → WAF + rate‑limit triggers; no auth
  bypass.
- Synthetic card‑testing pattern → Radar rule blocks; 402/429
  distribution as expected.
- NSFW seeding → never visible on public routes; staff override only.
- Webhook signatures & timestamp skew enforced; replay blocked.
- Alert on payout‑dest change without MFA.

**Artifacts.** *security/threat_model.md*,
*ops/runbooks/abuse_playbooks.md*, *tests/security/\*.spec.ts*.

**Acceptance.** All seeded abuses trigger controls; dashboards show
detection; no public NSFW leakage; payout hijack path requires MFA +
email confirm.

## **A2. DR / BCP (disaster recovery & business continuity)**

**Targets.** **RTO ≤ 4h**, **RPO ≤ 15m** for core transaction data.

**Data & services.**

- **Aurora Serverless v2**: multi‑AZ; snapshots hourly; PITR 7--14d;
  cross‑region replica optional (Phase‑2).
- **S3**: bucket versioning + lifecycle; replication for user media
  (Phase‑2).
- **Typesense**: daily snapshot; rebuild from outbox in ≤ 4h.
- **App & Lambdas**: infra as code; redeployable in clean region;
  secrets in KMS.

**Runbooks (one‑pager steps).**

5128. Declare incident & severity; freeze writes.
5129. Promote cross‑AZ or restore snapshot; re‑point AppSync env vars.
5130. Rehydrate Typesense from snapshot → replay outbox.
5131. Validate canary flows (login, search, checkout).
5132. Unfreeze writes & monitor SLOs.

**Tests.** Quarterly DR drill; timed restore to meet RTO/RPO;
post‑mortem with gaps & fixes.

**Artifacts.** *ops/runbooks/dr_restore.md*,
*ops/scripts/typesense_rebuild.ts*, *observability/dashboards/dr.json*.

**Acceptance.** Last drill met RTO/RPO; rebuild scripts current; staff
on‑call trained.

## **A3. Privacy & Data Lifecycle (retention, redaction, DSAR propagation)**

**Retention policy (examples; tune to legal):**

- **Orders, ledger, payouts**: 7 years.
- **Messages**: 24 months (unless legal hold).
- **Media originals**: owner's uploads retained; **public SFW variants**
  retained while published; deleted on DSAR.
- **Analytics events**: 18 months (aggregated beyond that).
- **Logs**: 30--90 days hot → Glacier 12 months.

**Deletion & DSAR propagation.**

- **Graph**: user→orders/threads/reviews/media→search index→analytics
  sessions.
- **Guarantee**: search purge ≤ 5m; analytics tombstones within nightly
  jobs.
- **Backups**: immutable; deletion not retroactive but not restored
  except for DR (documented).

**Artifacts.** *privacy/data_lifecycle.md*,
*ops/scripts/s3_l