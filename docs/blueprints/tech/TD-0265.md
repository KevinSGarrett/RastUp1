<!-- id: TD-0265 | source: ProjectPlans\TechnicalDevelopmentPlan.odt | range: 954000-958000 -->

. **Discover → Book (People)**: search → profile → message →
      checkout → success → receipt email.
4491. **Discover → Book (Studios)**: city landing → studio → add‑ons →
      deposit hold → success; buffers enforce.
4492. **Cancel/Refund**: buyer cancel across time‑bands → kernel applies
      → Stripe refund posted → ledger updated.
4493. **Support/DMCA**: open case → agent takedown → public page
      revalidated, asset hidden → restore.
4494. **Promotions**: Featured/Boost density cap respected; "Sponsored"
      labels always present; holdout remains organic.
4495. **Help deflection**: error → inline help → case NOT opened counts
      as deflection; attribution recorded.
4496. **DSAR**: request → export → delete → search & analytics purged
      within SLA.

Artifacts: *e2e/specs/\*.spec.ts* (Playwright), *e2e/fixtures/\*.ts*,
*e2e/utils/assertions.ts*.

## **1.25.5 Performance & CWV budgets**

- Budgets (Stage p75 / desktop+mobile):

  - LCP ≤ **2.5s**, CLS ≤ **0.1**, INP ≤ **200ms** (SEO §1.17
    alignment).
  - API p95: cached ≤ **200ms**, cache‑miss ≤ **450ms**; checkout p95 ≤
    **600ms**.

- **k6 scenarios** (*perf/k6/\*.js*):

  - search QPS ramp + 95th latency and error rate;
  - checkout flow with payment success/decline ratio;
  - indexer backlog under write spikes.

- **CI gating**: perf job runs on Stage nightly; PRs consume
  **lighthouse-ci** for CWV smoke on key pages.

Artifacts: *perf/k6/search.js*, *perf/k6/checkout.js*,
*.github/workflows/perf-nightly.yml*.

## **1.25.6 Accessibility (a11y)**

- **Automated**: axe‑core checks in CI against key routes; fail on
  **serious/critical**.
- **Manual**: keyboard‑only traversal for critical flows; color contrast
  spot‑checks; screen‑reader pass on nav and forms.
- **Artifacts**: *web/tests/a11y.spec.ts*, *web/a11y/aria-map.md*,
  *ops/runbooks/a11y-checklist.md*.

## **1.25.7 Security & privacy testing (execution details)**

- **Secrets**: trufflehog/secret‑scan on PR; seeded fake secrets to
  verify detection.
- **Headers**: CSP/HSTS/referrer policies asserted by tests.
- **WAF smoke**: synthetic malicious requests to Stage (allowlisted IP)
  return 403 with correct rule IDs.
- **PII audit**: grep‑style CI step rejects logging of emails/phones in
  server logs; unit tests verify masking helpers.
- **Stripe webhooks**: signature replay tests; idempotency test ensures
  upserts.

Artifacts: *.github/workflows/security.yml*,
*web/tests/security-headers.spec.ts*,
*services/tests/webhook-idempotency.spec.ts*.

## **1.25.8 Contract testing (GraphQL & webhooks)**

- **GraphQL**: snapshot & schema diff; backward‑compatibility checker
  ensures additive changes.
- **Webhooks**: JSON Schemas for Stripe/Plaid (optional), saved under
  *contracts/webhooks/\*.json*.
- **Search**: request/response contract for Typesense queries; Safe‑Mode
  filter asserted.

Artifacts: *contracts/graphql/schema.graphql*,
*contracts/webhooks/\*.json*, *contracts/search/typesense.json*.

## **1.25.9 CI/CD test pipelines (GitHub Actions)**

**Workflow overview**

- **build.yml**: type‑check, lint, unit tests, contract tests; upload
  coverage.
- **service‑int.yml**: spin local Postgres/Typesense via containers; run
  resolver tests.
- **e2e.yml**: deploy Amplify **Preview** → run Playwright in parallel
  shards → collect traces/videos → teardown.
- **a11y.yml**: run axe on key routes.
- **perf-nightly.yml**: run k6 on Stage; compare to budgets; open ticket
  on regressions.
- **release-qualify.yml** (Stage/Prod): smoke + canary monitor +
  rollback hooks (see §1.23).

**Sample** ***e2e.yml*** **(excerpt)**

*name: e2e*\
*on:*\
*pull_request:*\
*jobs:*\
*deploy-preview:*\
*runs-on: ubuntu-latest*\
*steps:*\
* - uses: actions/checkout@v4*\
* - name: Deploy Amplify Preview*\
*run: yarn ops:deploy:preview \# wrapper around Amplify Gen-2 preview*\
* - name: Save preview URL*\
*run: echo \"PREVIEW_URL=\$(cat .preview-url)\" \>\> \$GITHUB_ENV*\
\
*e2e:*\
*needs: deploy-preview*\
*runs-on: ubu