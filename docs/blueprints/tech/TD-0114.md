<!-- id: TD-0114 | source: ProjectPlans\TechnicalDevelopmentPlan.odt | range: 410400-414400 -->

. in stage; production
      dry‑run window; alarms on failures.
1981. **WAF**: simulate bursts; ensure rate rules and managed sets
      engage; false positives monitored.
1982. **SAST/IaC**: seed a vulnerable branch; CI blocks merge.
1983. **DR**: restore Aurora snapshot into a staging clone; validate
      integrity.
1984. **PII logging**: send synthetic PII; verify logs redaction and
      alerts.
1985. **Break‑glass**: test JIT admin; ensure revocation and audit
      entries present.

## **1.18.O Work packages (Cursor 4‑agent lanes)**

- **Agent A --- Auth & AppSync**: Cognito pools/claims, multi‑auth
  rules, entitlement resolvers, admin OIDC, JWT claims mapping.
- **Agent B --- Edge & WAF**: CloudFront behaviors, WAF rules & rate
  limits, webhook ingress gateway, Shield enrollment.
- **Agent C --- Secrets/KMS/Logs**: Secrets Manager structure, KMS CMKs
  & policies, CloudTrail to log‑archive, immutable audit append.
- **Agent D --- CI/CD & Detection**: CodeQL/Checkov gates, OIDC deploy
  roles, Security Hub/GuardDuty, IR runbooks, DR backup policies.

## **1.18.P Acceptance criteria (mark §1.18 FINAL only when ALL true)**

1990. Multi‑auth implemented (Cognito + IAM + OIDC) with least‑privilege
      resolvers; API key **off** in prod.
1991. Secrets stored in Secrets Manager; KMS keys per domain; rotation
      policy in place and tested.
1992. S3/Dynamo/Aurora encrypted; TLS enforced; PII redaction in logs
      verified.
1993. WAF deployed with managed rules + GraphQL rate limits; webhooks
      protected (HMAC or allowlist).
1994. Immutable audit for admin actions present; CloudTrail
      centralization to log‑archive with Object Lock.
1995. CI/CD has SAST/IaC gates; OIDC deployments; SBOM archived.
1996. IR/DR runbooks executed in stage; RPO/RTO met; backup health
      dashboard up.
1997. Security Hub/GuardDuty/Access Analyzer findings triaged; alerts
      wired.
1998. Costs within initial budgets; no paid security appliances required
      at launch.

# **§1.18 --- DevSecOps Addendum (Deep Completeness)**

Everything below is **text‑only artifacts** for your Word doc (each
includes a *Recommended filename/path* to lift later if you choose).

## **1.18.A Threat Model (assets, trust boundaries, controls)**

**Recommended path:** *security/threat-model/overview.md*

*Assets*\
*- A1: Money flows (Stripe Connect, payouts, refunds)*\
*- A2: PII (names, emails, phones), IDV artifacts (age/18+ evidence),
studio contracts*\
*- A3: Content previews (SFW only), deliverable manifests (hashes +
URLs)*\
*- A4: Auth & session tokens (Cognito JWTs, admin OIDC)*\
*- A5: Audit trails & evidence vault (DMCA, chargebacks)*\
*- A6: Secrets & keys (Stripe, KMS, Secrets Manager)*\
\
*Trust Boundaries*\
*- Edge (CloudFront/WAF) → App (Next.js/AppSync/Lambdas)*\
*- App → Data (Aurora/Dynamo/S3/Glue/Athena)*\
*- Providers (Stripe/IDV/e‑sign/SES) via webhooks*\
*- Admin/OIDC → AppSync Admin mode*\
\
*Primary Risks & Controls*\
*- Injection/XXE/SSRF → parameterized queries, SSRF‑blocked by VPC
egress policy, S3 Access Points*\
*- AuthZ bypass → AppSync \@auth rules + resolver checks + test matrix*\
*- Webhook replay → idempotency store + HMAC verification*\
*- PII leakage/logging → structured logs with redaction + log scans*\
*- DoS/Bot → WAF rate rules + GraphQL complexity limits + per‑actor
quotas*\
*- Content abuse → NSFW scanning + Safe‑Mode + DMCA pipeline*\

## **1.18.B Security Headers (CSP, Referrer, Permissions)**

**Recommended path:** *security/headers/response-headers.json*

*{*\
*\"Content-Security-Policy\": \"default-src \'self\'; img-src \'self\'*
[*https://cdn.rastup.com*](https://cdn.rastup.com) *data:; media-src
\'self\'* [*https://cdn.rastup.com*](https://cdn.rastup.com)*;
script-src \'self\'; style-src \'self\' \'unsafe-inline\'; font-src
\'self\' data:; connect-src \'self\'*
[*https://api.rastup.com*](https://api.rastup.com)*; frame-ancestors
\'none\'; base-uri \'self\'; form-action \'self\'\",*\
*\"Referrer-Policy\"