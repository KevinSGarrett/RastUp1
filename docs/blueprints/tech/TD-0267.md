<!-- id: TD-0267 | source: ProjectPlans\TechnicalDevelopmentPlan.odt | range: 961200-965200 -->

lerts open on
      regressions.

## **1.25.15 Artifacts (paste‑ready)**

- *jest.config.ts*, *playwright.config.ts*, *axe.config.js*
- *test/fixtures/\**, *e2e/specs/\**, *contracts/\**, *perf/k6/\*.js*
- .github/workflows/{build.yml,service-int.yml,e2e.yml,a11y.yml,perf-nightly.yml,release-qualify.yml}
- ops/runbooks/{test-data.md,release-checklist.md,rollback.md,triage_policy.md}

## **1.25.16 Acceptance criteria --- mark §1.25 FINAL only when ALL true**

4544. CI enforces coverage gates, a11y zero‑critical, contracts intact;
      failing gates block merge.
4545. E2E CUJs pass on Amplify Preview and Stage; traces and screenshots
      stored as artifacts.
4546. Perf budgets green (Stage p75 CWV & p95 API); k6 nightly runs
      succeed; regressions open issues automatically.
4547. Security/privacy checks pass (headers, WAF smoke, secret scan, no
      PII in logs).
4548. Release qualification checklist used on every Stage→Prod
      promotion; rollback runbook validated.
4549. Cost of CI kept in budget (E2E on demand + nightly; perf
      nightly/weekly).
4550. All artifacts and runbooks present in the repo.

# **§1.26 --- Mobile & PWA: Architecture, Offline, Push, Deep Links & Store Readiness**

**Full Technical Development Plan (single copy‑paste block for your
master doc)**

**Purpose.** Deliver a cost‑efficient mobile experience that supports
**camera→upload**, **messaging**, **search/discovery**,
**booking/checkout**, **help**, and **notifications**, with **offline
resilience**, **deep linking**, **sharecards**, and **Safe‑Mode**
guarantees. Start with a **PWA** (Add‑to‑Home‑Screen) to keep costs low,
while laying clean tracks to optional **React Native (Expo)** apps when
growth and engagement justify it. Integrates with **AppSync**, **Amplify
Gen‑2**, **Stripe**, **Calendar/Orders** (§1.12--§1.14),
**Notifications** (§1.10), **Media** (§1.11), **Search** (§1.18),
**Help** (§1.20), **Analytics/Experiments** (§1.21), and
**Security/Privacy** (§1.24).

## **1.26.1 Objectives & invariants**

4551. **Cost‑first**: PWA for GA; native apps (Expo RN) are a phase‑gate
      option with shared GraphQL contracts.
4552. **Offline‑friendly**: browsing, composing drafts, and queued
      uploads continue without network.
4553. **Push & deep links**: web push where supported; native push when
      RN ships; deep/universal links map to the same routes as web.
4554. **Media safety**: camera uploads route through S3 pre‑signed URLs
      → moderation → SFW variants before public surfacing.
4555. **No PII leakage**: tokens in secure storage; logs sanitized;
      screenshots guarded where appropriate.
4556. **One design system**: mobile shares tokens/components with web
      (responsive first; RN subset mirrors tokens).

## **1.26.2 Platform strategy & cost posture**

- **Phase‑1 (GA)** --- **PWA** only:

  - Next.js app with **Web App Manifest**, **Service Worker** (Workbox)
    for caching and offline shell.
  - **Web Push**: supported on Android/Chrome/Edge/Firefox; iOS Safari
    support exists but fragile---fallback to email/SMS when unsupported.
  - Add‑to‑Home‑Screen prompt on repeat visits; maskable icons & splash.

- **Phase‑2 (when metrics justify)** --- **React Native (Expo)** for
  iOS/Android:

  - Reuse **GraphQL** models and auth; keep surfaces nearly isomorphic
    to web to minimize feature fork.
  - **Expo EAS** for builds, OTA updates for non‑native code.
  - Native Push via **APNs/FCM**; background upload workers; richer
    camera.

**Cost guardrail**: we will not start native app work until PWA mobile
p75 **CWV** is green and weekly active mobile users justify it
(threshold set in §1.21 dashboards).

## **1.26.3 App architecture**

**PWA (web)**

- **Routing**: */m/\** routes mirror desktop; no separate codebase.

- **Service Worker** (SW):

  - *app-shell* cache (stale‑while‑revalidate),
  - *help/\** cached (1--7 days),
  - API GETs for read‑only pages cached (1--5 min) with **Safe‑Mode**
    awareness (cache 