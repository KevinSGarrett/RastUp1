<!-- id: TD-0087 | source: ProjectPlans\TechnicalDevelopmentPlan.odt | range: 313200-317200 -->

able if content not delivered/unavailable within X
  days; once **finals accessed**, refund eligibility drops unless
  quality dispute validated.
- **Requests**: if delivered and **buyer approved**, refund only via
  goodwill; if *revision loop* exhausted with unresolved defects,
  partial refund per tariff.
- **Tips**: non‑refundable except fraud.

**Escalation ladder**

1626. Auto‑decision (rules).
1627. Support agent decision with macros + reason codes.
1628. Supervisor dual‑approval when money impact \> threshold.
1629. Legal/T&S in DMCA or policy severe cases.

## **1.15.D State machines (high‑level)**

### **D.1 Generic Support Case**

*OPEN -\> (AwaitingCustomer \| AwaitingSeller \| Investigating)*\
*-\> DecisionPending -\> (Refunded \| Denied \| GoodwillCredit \|
Escalated)*\
*-\> Closed*\

- SLA timers on **first response** and **resolution**; pausing allowed
  when waiting on customer.

### **D.2 Booking dispute (people/studios)**

*Reported -\> EvidenceCollection (pull docs/messages/deliverables)*\
*-\> Adjudication (rules engine + agent)*\
*-\> Outcome: (FullRefund \| PartialRefund \| NoRefund \| DepositCapture
\[studio\])*\
*-\> Closed*\

### **D.3 Chargeback**

*Notified -\> EvidenceRequested (deadline T)*\
*-\> Represented (submitted) -\> (Won \| Lost)*\
*-\> (If Lost -\> GL expense; if Won -\> release hold)*\

### **D.4 DMCA**

*ClaimReceived -\> ContentHidden -\> NotifyCreator*\
*-\> (CounterNotice? -\> Review -\> RestoreOrKeepDown)*\
*-\> Closed*\

## **1.15.E Data model (Aurora + S3)**

*create table support_case (*\
*case_id text primary key, \-- sca\_\...*\
*type text not null check (type in
(\'booking\',\'payment\',\'product\',\'dmca\',\'policy\',\'chargeback\')),*\
*subtype text, \-- e.g., \'no_show\',\'quality\',\'duplicate_charge\'*\
*status text not null check (status in
(\'open\',\'awaiting_customer\',\'awaiting_seller\',\'investigating\',\'decision_pending\',\'refunded\',\'denied\',\'goodwill\',\'escalated\',\'closed\')),*\
*severity text not null check (severity in
(\'low\',\'normal\',\'high\',\'urgent\')),*\
*opened_by_user text not null, \-- usr\_\...*\
*owner_user_id text, \-- agent assigned*\
*watchers text\[\] not null default \'{}\',*\
*lbg_id text, \-- booking group*\
*leg_id text,*\
*order_id text, \-- fansub order (PPV/tip/request)*\
*studio_id text,*\
*creator_id text, \-- fansub_creator*\
*payout_id text, \-- if payout hold/release*\
*reason_code text, \-- normalized reason taxonomy*\
*sla_first_resp_at timestamptz,*\
*sla_due_at timestamptz,*\
*created_at timestamptz not null default now(),*\
*updated_at timestamptz not null default now()*\
*);*\
\
*create table support_message (*\
*msg_id text primary key, \-- smg\_\...*\
*case_id text not null references support_case(case_id) on delete
cascade,*\
*author_role text not null check (author_role in
(\'buyer\',\'seller\',\'studio_owner\',\'creator\',\'agent\',\'system\')),*\
*author_user_id text,*\
*body_md text not null, \-- markdown (sanitized)*\
*attachments_json jsonb not null default \'\[\]\'::jsonb, \-- \[{s3_key,
hash, bytes, mime}\]*\
*created_at timestamptz not null default now()*\
*);*\
\
*create table support_event (*\
*evt_id text primary key, \-- sev\_\...*\
*case_id text not null references support_case(case_id) on delete
cascade,*\
*action text not null, \--
\'status_change\',\'refund_issued\',\'deposit_captured\',\'evidence_attached\',\'hold_applied\',\'hold_released\',\'chargeback_represented\',\'dmca_hide\',\'dmca_restore\'*\
*actor_user_id text,*\
*details_json jsonb not null default \'{}\'::jsonb,*\
*created_at timestamptz not null default now()*\
*);*\
\
*\-- Calculated refund/goodwill outcomes (mirror §1.9 fee/tax logic)*\
*create table support_refund (*\
*refund_id text primary key, \-- srf\_\...*\
*case_id text not null references support_case(case_id) on delete
cascade,*\
*leg_id text,*\
*order_id text,*\
*amount_cents int not null,*\
*platform_fee_cents int not null,*\
*platform_fee_tax_cents int not null,*\
*reas