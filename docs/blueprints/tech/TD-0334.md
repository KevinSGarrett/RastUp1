<!-- id: TD-0334 | source: ProjectPlans\TechnicalDevelopmentPlan.odt | range: 1202400-1206400 -->

alendar\_\**,
      *search.outbox*, *abuse\_\**, *logs\_\**, *consent_events*,
      *dsar_audit*.

5677. **Retention policies** are codified in
      *governance/retention_policies.yml* and enforced by:

      z.  Postgres partitions + scheduled jobs,
      a.  Dynamo TTLs,
      b.  S3 lifecycle + Object Lock,
      c.  Typesense reindexing.

5678. **DSAR** export and delete runbooks implemented;
      *governance.anonymize_user* tested on a Stage clone; propagation
      to index/media/caches verified.

5679. **Consent ledger** is immutable and included in exports.

5680. **Logging redaction** gates in CI (Appendix L) pass; no PII in
      logs.

5681. **Lineage & catalog tags** applied in Glue (or equivalent) with
      table/column properties.

5682. **Alerts & dashboards** live; last monthly retention report
      archived.

# **Appendix M --- SBOM & Dependency Policy (deep version)**

**Purpose.** Guarantee supply-chain integrity and timely remediation for
vulnerabilities across **web**, **api/indexer**, and **containers**.
This appendix ships with: GitHub workflows, policy files, scanner
configs, and acceptance gates.

## **M.1 Scope & definitions**

- **Surfaces:** Next.js web, AppSync resolvers/Lambdas (Node 20),
  Typesense container (and any custom images), Lambda layers, CDK infra
  modules.
- **Artifacts:** SBOMs (CycloneDX JSON), vulnerability scan reports
  (SCA/SAST/Container), license reports, build provenance (optional
  signing).
- **SLA severities:** Critical ≤ **48h**, High ≤ **7d**, Medium ≤
  **30d**.

## **M.2 Repo structure (suggested)**

*/security/*\
*sbom/ \# generated files committed on release tags*\
*policies/*\
*dependency_policy.md*\
*license_allowlist.txt*\
*vuln_sla.md*\
*attestations/ \# optional cosign attestations*\
*/.github/workflows/*\
*security.yml \# SCA/SAST/container scan + SBOM*\
*deptrack-sync.yml \# push SBOM to Dependency-Track (optional)*\
*/infra/cdk/ \# IaC stacks*\

## **M.3 Dependency Policy (paste into** ***security/policies/dependency_policy.md*****)**

**Allowed licenses:** MIT, Apache-2.0, BSD-2/3, ISC, CC0.\
**Review required:** MPL-2.0, EPL-2.0.\
**Disallowed (fail build):** GPL-2/3, AGPL, SSPL (unless legal approval
is recorded).\
**Pinned packages:** *jsonwebtoken*, *bcrypt/argon2*, *aws-sdk*,
*\@graphql-tools/\** --- must use vetted versions in
*security/policies/pins.json*.\
**Node engines:** LTS only; upgrade within **60 days** of new LTS.

**Remediation SLAs:** Critical 48h / High 7d / Medium 30d; exception
file *security/vuln_exceptions.yaml* must include **owner**, **expiry**,
**compensating control**.

## **M.4 GitHub workflow --- SCA/SAST/Container + SBOM (*****.github/workflows/security.yml*****)**

*name: security*\
*on:*\
*pull_request:*\
*schedule:*\
* - cron: \"0 5 \* \* \*\" \# daily*\
*jobs:*\
*sca-sast:*\
*runs-on: ubuntu-latest*\
*strategy:*\
*matrix:*\
*project: \[web, api, infra\]*\
*steps:*\
* - uses: actions/checkout@v4*\
* - uses: actions/setup-node@v4*\
*if: matrix.project != \'infra\'*\
*with: { node-version: \'20\' }*\
* - name: Install deps*\
*if: matrix.project != \'infra\'*\
*run: \|*\
*cd \${{ matrix.project }}*\
*npm ci \--no-audit \--no-fund*\
* - name: Generate SBOM (CycloneDX)*\
*if: matrix.project != \'infra\'*\
*run: \|*\
*cd \${{ matrix.project }}*\
*npx \@cyclonedx/cyclonedx-npm \--output-format json \--spec-version 1.5
\--output-file ../../security/sbom/\${{ matrix.project }}-\${{
github.sha }}.json*\
* - name: SCA (osv-scanner)*\
*uses: google/osv-scanner-action@v1*\
*with:*\
*path: \${{ matrix.project }}*\
*fail-on-severity: HIGH*\
* - name: SAST (CodeQL)*\
*uses: github/codeql-action/init@v3*\
*with: { languages: javascript }*\
* - name: CodeQL analyze*\
*uses: github/codeql-action/analyze@v3*\
\
*container-scan:*\
*runs-on: ubuntu-latest*\
*steps:*\
* - uses: actions/checkout@v4*\
* - name: Build Typesense image (if custom)*\
*run: \|*\
*docker build -t rastup/typesense:scan ./search/*\
* - name: Trivy scan*\
*uses:*
[*aqu