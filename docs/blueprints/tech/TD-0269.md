<!-- id: TD-0269 | source: ProjectPlans\TechnicalDevelopmentPlan.odt | range: 968400-972400 -->

sage.send*,
  *profile.edit*, *media.upload.complete*, *checkout.start*) with
  conflict handling:

  - **Last‑write‑wins** on idempotent edits;
  - **Merge** for drafts;
  - **Abort** for expired checkouts.

- **Read caching**: profile/studio pages & help articles cached;
  invalidate via SW message on publish events.

- **Safe‑Mode when offline**: render only **SFW** cached content;
  non‑SFW originals never cached.

## **1.26.8 Notifications --- mobile specifics (ties to §1.10)**

- **Web Push (PWA)**:

  - Permission prompt only on **user action** (per standards).
  - Topic bucketing by **city**, **role**, **saved search**, **thread**.
  - Fallback to **email/SMS** when push unsupported or disabled.

- **Native Push (Expo RN)** *(Phase‑2)*:

  - APNs/FCM integration; background handlers update badges; deep link
    payload points to route.

- **Preference center**: surfaces *device.pref* with preview; honors
  **quiet hours**; emergency messages bypass per §1.10 policy.

## **1.26.9 Deep links, sharecards & universal links**

- **URL scheme**: all share links are canonical **web URLs** (e.g.,
  */@handle*, */studio/{slug}*, */work/{id}*) with Open Graph tags
  (§1.16).

- **Native routing (Phase‑2)**:

  - iOS **Universal Links**: *apple-app-site-association* file;
  - Android **App Links**: *assetlinks.json*.

- **Fallback**: if app not installed, links open web page (PWA).

- **Deferred deep links**: optional; track via click token (§1.21) and
  post‑install attribution.

## **1.26.10 Authentication, security & privacy on mobile**

- **PWA**: auth via HTTP‑only cookies; refresh via AppSync; no tokens in
  localStorage.
- **RN**: tokens in OS‑secure storage
  (Keychain/EncryptedSharedPreferences); device PIN/biometrics optional
  for step‑up.
- **Logs**: scrub emails/phones; redact EXIF on images; block screen
  capture on **payment** and **IDV** screens (RN).
- **GDPR/DSAR**: mobile honors DSAR deletions; clears caches/outbox;
  unregisters push tokens.

## **1.26.11 Accessibility & UX standards (mobile)**

- **Tap targets** ≥ 44px; focus order and visible focus; pref‑reduced
  motion; dark mode supported.
- ARIA roles & labels for interactive components; a11y audits in CI (axe
  for web; RN a11y checks).
- **Language** attribute reflects selected locale (§1.25); RTL
  scaffolding in place.

## **1.26.12 Performance budgets (mobile)**

- **PWA CWV (p75, mobile)**: LCP ≤ **2.5s**, INP ≤ **200ms**, CLS ≤
  **0.1**.
- **App start (RN)**: TTI ≤ **2.0s** warm; **\<4.0s** cold on test
  devices.
- **Network**: images lazy‑loaded; media placeholder skeletons; GraphQL
  persisted queries; gzip/brotli; HTTP/2 or HTTP/3.

## **1.26.13 QA & device matrix**

- **Device matrix** (minimum):

  - iOS: 2 recent iPhones (latest major −1), iPad (responsive checks).
  - Android: 3 device classes (low, mid, high) across recent OS
    versions.
  - Chrome/Edge/Firefox/Safari mobile for PWA.

- **Automation**:

  - PWA: Playwright mobile emulation + Lighthouse CI for CWV.
  - RN: Detox (Phase‑2) for critical flows; Maestro optional for
    cross‑platform flakiness.

## **1.26.14 App store readiness (Phase‑2)**

- **Privacy manifests** listing data categories; tracking only with
  consent.
- **Sign‑in with Apple** if other social logins are present (iOS
  policy).
- Testflight/Internal testing tracks; staged rollouts (5%→25%→100%);
  crash/error dashboards.

## **1.26.15 Work packages (Cursor --- 4 agents)**

- **Agent A --- PWA Core**: Service Worker, manifest, caching
  strategies, offline shell, A2HS prompts.
- **Agent B --- Media & Outbox**: pre‑signed chunked uploads, resumable
  queue, EXIF strip, moderation hooks.
- **Agent C --- Push & Deep Links**: device register GraphQL, prefs
  center, Web Push, deep link router; later APNs/FCM setup.
- **Agent D --- Quality & Perf**: mobile CWV budgets/Lighthouse CI, a11y
  checks, device matrix & runbooks; RN Detox harness (Phase‑2).

## **1.26.16 Tests (representative)**

4602. **Offline**: cach