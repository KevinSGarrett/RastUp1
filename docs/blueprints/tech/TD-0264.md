<!-- id: TD-0264 | source: ProjectPlans\TechnicalDevelopmentPlan.odt | range: 950400-954400 -->

 is token‑only;
      webhooks hardened & idempotent.
4470. Security lake/detections and IR playbooks are in place; a drill
      has been run and documented.
4471. Costs are controlled (native services, scoped enablement,
      retention/lifecycle rules).

# **§1.25 --- Quality Engineering & Test Strategy (Automation, Performance, Accessibility & Release Qualification)**

**Full Technical Development Plan (single copy‑paste block for your
master doc)**

**Purpose.** Guarantee that every feature described in the non‑technical
plan ships **correct, fast, accessible, safe, and cost‑efficiently**.
Define a test taxonomy, fixtures, pipelines, budgets, and sign‑off so
releases are predictable. Integrates with **Amplify Gen‑2**,
**AppSync**, **Aurora**, **Typesense**, **Stripe**, **Search (§1.18)**,
**Studios (§1.19)**, **Help (§1.20)**, **Analytics (§1.21)**, **Admin
(§1.22)**, and **Platform (§1.23)**. Designed to run with **Cursor (4
agents)** in parallel.

## **1.25.1 Objectives & invariants**

4472. **Shift‑left:** most bugs caught at PR time; CI is the gate.
4473. **Representative data:** deterministic fixtures + sanitized Stage
      snapshot for realism.
4474. **Safety invariants:** **SFW public**, **no PII leakage**,
      **atomic booking**, **no double‑book**, **PCI SAQ‑A compliance**
      are continuously tested.
4475. **Performance budgets:** CWV p75 and API p95 targets enforced.
4476. **Cost discipline:** parallelize where it saves time; keep heavy
      suites nightly on Stage.

## **1.25.2 Test taxonomy & coverage targets**

- **Unit tests** (targets ≥ **80%** statements / **70%** branches): pure
  functions, resolvers, pricing kernel, refund kernel.
- **Service‑integration tests**: AppSync resolver → Lambda →
  Aurora/Typesense (local containers or Stage with test schema).
- **Contract tests**: GraphQL schema, webhook payloads (Stripe), search
  query contracts.
- **End‑to‑end (E2E)**: Playwright against **Amplify Preview** (Dev PR)
  and **Stage** (nightly).
- **Visual regression**: Playwright image snapshots on critical flows
  (public pages, checkout).
- **A11y tests**: axe‑core automated checks + keyboard navigation
  sanity.
- **Performance/load**: k6 scenarios (API + SSR pages) with budgets.
- **Security privacy checks**: seeded secret tests, CSP headers, WAF
  smoke via test harness.
- **Data quality** (analytics): event schema validation and joinability
  to sessions/orders.

Coverage **gates** by layer (fail PR if below):\
*unit \>= 80%*, *service-integration \>= 60%*, *E2E critical paths =
100% pass*, *a11y = 0 critical*.

## **1.25.3 Fixtures & test data**

- **Deterministic fixtures** (*/test/fixtures*):

  - users (buyer/provider/admin), verified and unverified, different
    countries;
  - profiles & studios with diverse amenities/price bands;
  - reviews with known distributions (incl. low‑count edge cases);
  - calendars with buffers/blackouts;
  - orders (pending/paid/refunded/disputed);
  - help articles (public/internal).

- **Sanitized Stage snapshot**: nightly masked copy of select tables for
  realism (emails → [*user+id@example.com*](mailto:user+id@example.com),
  phones → dummy formats; addresses → city‑level only).

- **Stripe test tokens**: card success/failure patterns,
  refund/chargeback simulators (test mode).

- **Search**: seed Typesense with SFW‑only variants; explicit NSFW seeds
  live only in private test buckets for safety tests.

Artifacts: *test/seed/seed.ts*, *ops/runbooks/test-data.md*,
*ops/scripts/stage-sanitize.sql*.

## **1.25.4 Critical user journeys (CUJs) --- E2E suite**

4490. **Discover → Book (People)**: search → profile → message →
      checkout → success → receipt email.
4491. **Discover → Book (Studios)**: city landing → studio → add‑ons →
      deposit hold → success; buffers enforce.
4492. **Cancel/Refund**: buyer cancel across time‑bands → kernel applies
      → Stripe refund posted → ledger updated.
4493. **Support/DMCA**: open case → agent takedown → public