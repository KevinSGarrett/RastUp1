<!-- id: TD-0132 | source: ProjectPlans\TechnicalDevelopmentPlan.odt | range: 475200-479200 -->

[Transfer!\]!,
refunds: \[Refund!\]!*\
*}*\
*type Transfer { xferId: ID!, stripeTransfer: String, amountCents: Int!,
status: String! }*\
*type Refund { refundId: ID!, stripeRefund: String, amountCents: Int!,
reason: String! }*\
\
*extend type Query {*\
*adminGetOrder(orderId: ID!): PaymentAdmin! \@auth(role: \"admin\")*\
*}*\
*extend type Mutation {*\
*adminRefund(orderId: ID!, amountCents: Int!, reason: String!): Boolean!
\@auth(role: \"admin\")*\
*adminHoldPayout(orderId: ID!, reason: String!): Boolean! \@auth(role:
\"admin\")*\
*adminReleasePayout(orderId: ID!): Boolean! \@auth(role: \"admin\")*\
*}*\

## **1.22.14 Telemetry, SLOs & cost**

- **Events:** *checkout.start\|confirm\|success\|fail*, *refund.create*,
  *dispute.open\|won\|lost*, *transfer.create\|paid*,
  *payout.paid\|failed*.
- **KPIs:** checkout conversion, authorization/capture rates, refund %,
  dispute %, T+N transfer SLA, webhook latency.
- **SLOs:** payment success p50 ≥ **96% (cards)**; webhook processing
  p95 ≤ **2s**; transfer execution after completion p95 ≤ **15m**; D+1
  reconciliation completeness by **08:00 UTC**.
- **Cost posture:** Stripe only at launch; **ACH** only when volume
  justifies; no third‑party fraud SaaS initially---rely on Stripe
  Radar + our risk flags; serverless webhooks & nightly reconciliation
  to keep compute low.

## **1.22.15 Test plan**

2179. Card happy path (with/without credits), receipts.
2180. Manual capture (authorize, capture/void) path.
2181. Refunds (full/partial) per policy; credits re‑application logic.
2182. Disputes lifecycle (open → evidence → closed win/loss) and payout
      clawback/release.
2183. ACH flow (when enabled): settlement timing; transfer after funds
      clear.
2184. Webhooks idempotency: replay same *event.id* → no duplicate
      effects.
2185. Reconciliation: balance transactions vs ledgers; variance ≤ \$0.01
      per order.
2186. Risk: forced 3DS; rate‑limit card attempts; apply reserve.

## **1.22.16 Work packages (Cursor 4‑agent lanes)**

- **Agent A --- Buyer Checkout & Credits:** PI creation/confirm, credits
  application, receipts, error handling.
- **Agent B --- Provider Onboarding & Payouts:** Connect Express flow,
  payout schedule/reserves, transfer logic, statements.
- **Agent C --- Webhooks & Reconciliation:** webhook lambdas +
  idempotency, ledgers, daily Stripe exports, Silver model & dashboards.
- **Agent D --- Admin & Risk:** finance console, refunds/holds/releases,
  dispute evidence packs, risk flagging & decisions.

## **1.22.17 Acceptance criteria --- mark §1.22 FINAL only when ALL true**

2191. Checkout supports cards (Apple/Google Pay where available);
      credits apply to **buyer_fee** only; orders reach *captured*.
2192. Provider onboarding via Connect Express; payouts scheduled per
      policy; reserves supported.
2193. Webhooks idempotent; state machine transitions correct;
      clawbacks/holds work.
2194. Refunds/disputes complete end‑to‑end with accurate ledger entries
      and communications.
2195. **Separate charges & transfers** implemented with controllable
      transfer timing; reconciliation (Silver) runs without variances.
2196. Admin console (role‑gated) supports refund/hold/release &
      evidence; all actions audited.
2197. KPIs/SLOs measured with alerts; D+1 reconciliation completes by
      **08:00 UTC**.
2198. Costs within launch budgets; ACH deferred until justified.

# **§1.23 --- Messaging, Inbox & Collaboration (Technical Spec)**

**Scope:** This section implements the non‑technical "SubSection 1.4 ---
Messaging, Inbox & Collaboration UX" in full technical detail (objects,
flows, folders, filters, credits, action cards, safety controls). The
non‑technical goals include role‑aware & booking‑aware threads, a single
source of truth for chat + project context, respectful fast
communication (receipts, templates), and strong
safety/anti‑circumvention tooling, including report/block and rate
limits.

NonTechBlueprint

In addition, Trust & S