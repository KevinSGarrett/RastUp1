<!-- id: TD-0125 | source: ProjectPlans\TechnicalDevelopmentPlan.odt | range: 450000-454000 -->

 mutations.
- **Agent D --- QA/Perf**: device matrix, Lighthouse CI, CWV field
  beacons, a11y runs, perf tuning.

## **1.20.R Acceptance criteria --- mark §1.20 FINAL only when ALL true**

2098. PWA installable; offline works for defined scopes; background
      retry for uploads/messages.
2099. Push notifications delivered via Pinpoint/SNS to Web/iOS/Android
      with quiet hours & caps; deep links open the correct screen.
2100. Camera/gallery uploads succeed with on‑device resize, EXIF strip
      by default, S3 presigned PUT, and server‑side scans.
2101. Safe‑Mode and age gating enforced consistently; no 18+ previews in
      notifications or public pages.
2102. Mobile performance budgets met; a11y checks pass on PWA and RN
      shells (if used).
2103. CI/CD pipelines in place for PWA (Amplify/CloudFront) and, if
      used, RN shells (EAS/TestFlight/Play internal).
2104. Telemetry and crash/error reporting active; event taxonomy
      integrated with §1.13.

# **§1.21 --- Search, Discovery & Ranking Engine (Re‑issued in full, sequential order)**

*This is the same complete §1.21 I produced earlier, re‑posted here to
maintain strict numeric order in your master Word document. Everything
is text‑only and copy‑pasteable, with "Recommended filename/path"
markers for later lift‑and‑shift.*

## **1.21.A Index documents & schemas**

We maintain two primary collections: *people_v1* and *studios_v1*. All
public fields are **SFW‑only** (no 18+ media or attributes).
Private/sensitive fields never enter search docs.

**Recommended path:** *search/schemas/typesense.json*

*{*\
*\"collections\": \[*\
*{*\
*\"name\": \"people_v1\",*\
*\"fields\": \[*\
*{\"name\":\"id\",\"type\":\"string\"},*\
*{\"name\":\"handle\",\"type\":\"string\"},*\
*{\"name\":\"displayName\",\"type\":\"string\"},*\
*{\"name\":\"roles\",\"type\":\"string\[\]\",\"facet\":true},*\
*{\"name\":\"genres\",\"type\":\"string\[\]\",\"facet\":true},*\
*{\"name\":\"city\",\"type\":\"string\",\"facet\":true},*\
*{\"name\":\"region\",\"type\":\"string\",\"facet\":true},*\
*{\"name\":\"country\",\"type\":\"string\",\"facet\":true},*\
*{\"name\":\"lat\",\"type\":\"float\"},*\
*{\"name\":\"lon\",\"type\":\"float\"},*\
*{\"name\":\"verified\",\"type\":\"bool\",\"facet\":true},*\
*{\"name\":\"trusted\",\"type\":\"bool\",\"facet\":true},*\
*{\"name\":\"nsfw_band\",\"type\":\"int32\",\"facet\":true},*\
*{\"name\":\"priceFromCents\",\"type\":\"int64\",\"facet\":true},*\
*{\"name\":\"priceToCents\",\"type\":\"int64\",\"facet\":true},*\
*{\"name\":\"amenities\",\"type\":\"string\[\]\",\"facet\":true},*\
*{\"name\":\"packagesCount\",\"type\":\"int32\"},*\
*{\"name\":\"repScore\",\"type\":\"float\"},*\
*{\"name\":\"recencyScore\",\"type\":\"float\"},*\
*{\"name\":\"engagementScore\",\"type\":\"float\"},*\
*{\"name\":\"availabilityScore\",\"type\":\"float\"},*\
*{\"name\":\"completenessScore\",\"type\":\"float\"},*\
*{\"name\":\"updatedAt\",\"type\":\"int64\"},*\
*{\"name\":\"createdAt\",\"type\":\"int64\"}*\
*\],*\
*\"default_sorting_field\": \"updatedAt\"*\
*},*\
*{*\
*\"name\":\"studios_v1\",*\
*\"fields\":\[*\
*{\"name\":\"id\",\"type\":\"string\"},*\
*{\"name\":\"slug\",\"type\":\"string\"},*\
*{\"name\":\"name\",\"type\":\"string\"},*\
*{\"name\":\"city\",\"type\":\"string\",\"facet\":true},*\
*{\"name\":\"region\",\"type\":\"string\",\"facet\":true},*\
*{\"name\":\"country\",\"type\":\"string\",\"facet\":true},*\
*{\"name\":\"lat\",\"type\":\"float\"},*\
*{\"name\":\"lon\",\"type\":\"float\"},*\
*{\"name\":\"verified\",\"type\":\"bool\",\"facet\":true},*\
*{\"name\":\"nsfw_band\",\"type\":\"int32\",\"facet\":true},*\
*{\"name\":\"amenities\",\"type\":\"string\[\]\",\"facet\":true},*\
*{\"name\":\"priceFromCents\",\"type\":\"int64\",\"facet\":true},*\
*{\"name\":\"priceToCents\",\"type\":\"int64\",\"facet\":true},*\
*{\"name\":\"sizeSqFt\",\"type\":\"int32\",\"facet\":true},*\
*{\"name\":\"recencyScore\",\"type\":\"float\"},*\
*{\"name\":\"engagementScore\",\"type\":\"float\"},*\
*