<!-- id: TD-0227 | source: ProjectPlans\TechnicalDevelopmentPlan.odt | range: 817200-821200 -->

\...*\
*scope text not null check (scope in (\'people\',\'studios\')),*\
*city text not null,*\
*query_json jsonb not null, \-- ANY/ALL filters*\
*paused_until date,*\
*last_alert_dt date,*\
*created_at timestamptz default now(),*\
*updated_at timestamptz default now()*\
*);*\
\
*create table growth.saved_search_alert (*\
*alert_id text primary key, \-- ssa\_\...*\
*search_id text not null references growth.saved_search(search_id) on
delete cascade,*\
*alert_dt date not null,*\
*match_count int not null,*\
*email_sent boolean default false,*\
*inapp_created boolean default false,*\
*created_at timestamptz default now(),*\
*unique (search_id, alert_dt)*\
*);*\
\
*create table growth.follow (*\
*follower_user_id text not null, \-- usr\_\...*\
*target_id text not null, \-- usr\_\... or fsc\_\...*\
*target_kind text not null check (target_kind in
(\'service_profile\',\'fansub_creator\')),*\
*created_at timestamptz default now(),*\
*primary key (follower_user_id, target_id, target_kind)*\
*);*\
\
*create table growth.feed_post (*\
*feed_id text primary key, \-- fdp\_\...*\
*author_id text not null,*\
*role_tags text\[\] not null,*\
*kind text not null check (kind in
(\'case_study\',\'availability\',\'touring\',\'studio_slot\',\'influence\')),*\
*title text not null,*\
*body_md text,*\
*media_preview jsonb not null default \'\[\]\',*\
*nsfw_band int not null default 0,*\
*city text,*\
*verified_chip boolean not null default false,*\
*is_published boolean not null default false,*\
*created_at timestamptz default now(),*\
*updated_at timestamptz default now()*\
*);*\
\
*create table growth.referral_program (*\
*program_id text primary key, \-- rpr\_\...*\
*kind text not null check (kind in
(\'provider_invites_provider\',\'buyer_invites_buyer\',\'cross_side\')),*\
*reward_bips int not null default 0,*\
*reward_fixed_cents int not null default 0,*\
*credit_scope text not null, \-- \'buyer_fee_only\'*\
*monthly_cap int not null default 5,*\
*active boolean not null default true,*\
*created_at timestamptz default now()*\
*);*\
\
*create table growth.referral_invite (*\
*invite_id text primary key, \-- rfi\_\...*\
*program_id text not null references
growth.referral_program(program_id),*\
*inviter_user_id text not null,*\
*invitee_user_id text,*\
*invitee_email_sha text not null,*\
*source text, \-- \'sharecard\',\'linkinbio\', etc.*\
*device_fp text,*\
*ip_addr_sha text,*\
*created_at timestamptz default now(),*\
*accepted_at timestamptz*\
*);*\
\
*create table growth.credit_ledger (*\
*entry_id text primary key, \-- crl\_\...*\
*user_id text not null,*\
*kind text not null check (kind in
(\'award\',\'clawback\',\'redeem\')),*\
*program_id text,*\
*amount_cents int not null,*\
*currency text not null default \'USD\',*\
*reason text not null,*\
*related_id text,*\
*created_at timestamptz default now()*\
*);*\
\
*commit;*\

## **2) GraphQL (AppSync) --- saved search, feed, referrals**

*scalar AWSJSON*\
*scalar AWSDate*\
*scalar AWSDateTime*\
\
*type SavedSearch { searchId: ID!, scope: String!, city: String!,
queryJson: AWSJSON!, pausedUntil: AWSDate, lastAlertDt: AWSDate,
createdAt: AWSDateTime!, updatedAt: AWSDateTime! }*\
*type SavedSearchAlert { alertId: ID!, searchId: ID!, alertDt: AWSDate!,
matchCount: Int!, emailSent: Boolean!, inappCreated: Boolean!,
createdAt: AWSDateTime! }*\
\
*type FeedCard { feedId: ID!, authorId: ID!, roleTags: \[String!\]!,
kind: String!, title: String!, bodyMd: String, mediaPreview: AWSJSON!,
city: String, verifiedChip: Boolean!, createdAt: AWSDateTime! }*\
*type FeedPage { items: \[FeedCard!\]!, cursor: String }*\
\
*type ReferralInvite { inviteId: ID!, programId: ID!, inviterUserId:
ID!, acceptedAt: AWSDateTime }*\
*type CreditLedger { entryId: ID!, userId: ID!, kind: String!,
amountCents: Int!, reason: String!, createdAt: AWSDateTime! }*\
\
*input SavedSearchInput { scope: String!, city: String!, queryJson:
AWSJSON! }*\
\
*type Query {*\
*mySavedSearches: \[SavedSearch!\]!*\
*myFeed(cursor: String, limit: