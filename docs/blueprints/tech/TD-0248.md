<!-- id: TD-0248 | source: ProjectPlans\TechnicalDevelopmentPlan.odt | range: 892800-896800 -->

 (when
      applicable), SFW images, and are included in */sitemap-help.xml*.
4086. Internal articles are **not indexable**, never appear in public
      search or sitemaps.
4087. Troubleshooter flows work end‑to‑end and can open typed Support
      cases with pre‑filled payloads.
4088. Review cycle + stale content alerts function; editors can
      publish/redirect safely.
4089. Search integration live; suggestions show top help results;
      internal never leaks.
4090. Deflection, helpful ratio, and stale backlog dashboards live;
      **deflection rate** target configurable.
4091. Costs remain within serverless budget; ISR revalidation on updates
      ≤ 10 minutes.

# **§1.20 --- Hardening Addendum (paste directly after §1.20.15)**

### **1.20.16 Promotions Quality Score (QS) --- ordering within paid caps**

**Goal.** Use a **Quality Score** to order paid candidates **inside**
the capped sponsored positions (never outside filter match), as
described in your plan.

- Definition (per city×role):

*QS = 0.45 \* PredictedCTR*\
* + 0.35 \* PredictedBookingLift \# incremental vs. organic baseline*\
* + 0.10 \* ProfileHealth \# rating \* log(reviews+1), cancel-rate
inverse, verified_chip*\
* + 0.10 \* CreativeQualityProxy \# image sharpness/coverage, SFW
compliance, recency*\

Bounded to \[0.3, 1.3\] to avoid runaway weights; cold‑start defaults to
0.7.

- **Serving order for each sponsored slot:**\
  *order_score = min(max_cpc, cap) / cap × QS* (ties broken by
  time‑since‑last‑exposed to ensure fairness).\
  This **replaces** the simple "bid × quality" heuristic in §1.20.5 for
  Boost.

- Offline training (Phase‑1):

  - Labels: clicks and booking initiations attributed to **paid
    impressions**; use **holdout** cells (from
    *city_config.holdout_pct*) to compute **incremental** lift.
  - Features: prior CTR, prior booking rate, rating/reviews,
    verified_chip, availability score, price competitiveness band, image
    coverage metrics, city/role, device, time of day.
  - Models: logistic (CTR) and uplift/2‑model for booking lift;
    recalibrate weekly.

- **Online update:** refresh QS nightly; warm candidates when profiles
  change.

- **Abuse guardrails:** cap QS when review_count \< 5; down‑weight rapid
  "cosmetic" edits (change‑rate limiter).

**Artifacts:**

- *services/promotions/quality_score.py* (batch trainer),
- *jobs/promotions_qs_refresh.yml* (nightly schedule),
- *observability/dashboards/promotions_qs.md* (drift/precision).

### **1.20.17 Auto‑coaching & nudges (provider UX)**

**Triggers (weekly):**

- 7‑day **ROAS \< 1.5×** → inline coach: "Improve images or adjust bid;
  see checklist."
- 14‑day **ROAS \< 1.0×** → recommend **Pause**; link to help article
  and QS drivers.
- **Invalid‑click refunds \> 8%** → info banner explaining filters and
  best practices.

**UI hooks:** surfaced in *web/promotions/Manager.tsx*, with links to
Help Center (§1.20) and media tips (§1.11).

**Events:** *promo.autocoach.shown\|clicked\|dismissed*.

### **1.20.18 RFP/Brief credits --- clarify buyer‑side ownership**

Your non‑technical Appendix defines **RFP** as a **buyer/brand**
broadcasting a brief to vetted providers. Accordingly:

- **Semantics:** *promo.brief_wallet.user_id* refers to the
  **buyer/brand account** (not the provider).
- **Consumption rule:** 1 credit **per new recipient** in a broadcast
  brief; if an open thread exists with that provider in the last 30
  days, **no** credit is consumed.
- **Renewals (optional):** verified brands receive **N** free credits
  per week (configurable per city).
- **Admin visibility:** city‑level usage and abuse signals (e.g.,
  mass‑spam attempts) in the console.

*(No schema change needed---the existing tables already key by user_id;
we're specifying the **account role** is "buyer/brand" for this
wallet.)*

### **1.20.19 Compliance, labels & fairness**

- **Labeling:** "Sponsored"/"Featured" chip on all paid units; tooltip
  explains matching rules.
- **Organic share g