<!-- id: TD-0319 | source: ProjectPlans\TechnicalDevelopmentPlan.odt | range: 1148400-1152400 -->

.add(res.timings.duration);*\
*// open thread*\
*if (res.status === 200 && res.json(\'threads\')?.length) {*\
*const id = res.json(\'threads\')\[0\].id;*\
*res = http.get(\`\${BASE}/api/messages/thread/\${id}\`);*\
*const ok = check(res, { \'thread 200\': r =\> r.status === 200 });*\
*MsgOK.add(ok);*\
*}*\
*sleep(0.5);*\
*}*\

**CI workflow (*****.github/workflows/perf.yml*****)**

*name: perf*\
*on:*\
*workflow_dispatch:*\
*schedule:*\
* - cron: \"0 6 \* \* \*\" \# daily 06:00 UTC*\
*jobs:*\
*k6:*\
*runs-on: ubuntu-latest*\
*strategy:*\
*matrix:*\
*script: \[search.js, checkout.js, messages.js\]*\
*steps:*\
* - uses: actions/checkout@v4*\
* - name: Install k6*\
*run: \|*\
*sudo gpg -k \|\| true*\
*curl -s*
[*https://packagecloud.io/install/repositories/loadimpact/k6/script.deb.sh*](https://packagecloud.io/install/repositories/loadimpact/k6/script.deb.sh)
*\| sudo bash*\
*sudo apt-get install -y k6*\
* - name: Run k6*\
*env: { BASE_URL: \${{ secrets.PERF_BASE_URL }} }*\
*run: k6 run perf/k6/\${{ matrix.script }}*\

# **Appendix Z --- Incident Management (deep version)**

## **Z.1 Severity levels & examples**

- **SEV-1** (Critical): payments down, major PII exposure, widespread
  outage.
- **SEV-2** (High): checkout degradation, search results invalid, DMCA
  flood.
- **SEV-3** (Medium): minor feature outage, partial region issue.
- **SEV-4** (Low): cosmetic bugs, minor latency.

## **Z.2 Roles**

- **Incident Commander (IC)**, **Ops**, **Comms**, **Scribe**,
  **Resolver(s)**.

## **Z.3 Paging rules**

- Alerts that page must be **actionable**; no pages for known noisy
  metrics.
- SEV-1: page **primary & secondary** simultaneously; IC within 5
  minutes.

## **Z.4 Comms templates (copy into** ***ops/templates/*****)**

**Slack (war-room channel)**

*\[SEV-\<n\>\] \<short title\>*\
*Start: \<UTC time\>*\
*IC: \<name\>, Scribe: \<name\>*\
*Impact: \<who/what/where\>*\
*Hypotheses:*\
*Mitigations tried:*\
*Next update at: \<time\>*\

**Status page --- initial**

*Title: Degraded performance in \<component\>*\
*Body: We are investigating elevated errors/latency in \<component\>.
Bookings and messaging may be impacted for some users.*\
*Start: \<time UTC\>*\
*Next update: \<+30 minutes\>*\

**Customer email --- resolved**

*Subject: Incident on \<date\> has been resolved*\
*Body: Between \<time range UTC\>, some users experienced \<impact\>.
The issue has been resolved. Root cause: \<high-level\>. We are taking
the following steps to prevent recurrence: \<bullets\>. We apologize for
the disruption.*\

## **Z.5 Timeline of a typical SEV-1**

5540. IC declared, roles assigned, status page updated.
5541. Mitigate (flip feature flags, rollback, scale).
5542. Diagnose with logs/traces; fix; monitor.
5543. Resolve & close; postmortem within **5 business days**.

## **Z.6 Postmortem template**

*Summary:*\
*Timeline:*\
*Customer impact:*\
*Root cause:*\
*Fix:*\
*Action items (owner, due):*\
*Lessons:*\

## **Z.7 Acceptance**

- Last drill met paging and comms SLAs; postmortems exist for SEV-1/2;
  action items tracked.

# **Appendix AC --- FinOps & Cost Guardrails (deep version)**

## **AC.1 AWS Budgets YAML (*****ops/finops/budgets.yml*****)**

*budgets:*\
* - name: s3-monthly*\
*amount_usd: 250*\
*tag: service:s3*\
*alerts:*\
* - threshold: 70*\
* - threshold: 90*\
* - threshold: 100*\
* - name: lambda-monthly*\
*amount_usd: 400*\
*tag: service:lambda*\
*alerts: \[70, 90, 100\]*\
* - name: aurora-monthly*\
*amount_usd: 1200*\
*tag: service:aurora*\
*alerts: \[70, 90, 100\]*\
* - name: cloudfront-monthly*\
*amount_usd: 600*\
*tag: service:cloudfront*\
*alerts: \[70, 90, 100\]*\
* - name: typesense-monthly*\
*amount_usd: 300*\
*tag: service:typesense*\
*alerts: \[70, 90, 100\]*\

## **AC.2 Unit-economics SQL (Athena) ---** ***analytics/sql/unit_economics.sql***

*WITH cost AS (*\
*SELECT service, SUM(cost_usd) AS usd*\
*FROM finops.daily_service_cost*\
*WHERE dt BETWEEN date_trunc(\'month\', current_date) AND current_date*\
*GROUP BY 1*