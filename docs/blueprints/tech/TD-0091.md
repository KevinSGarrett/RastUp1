<!-- id: TD-0091 | source: ProjectPlans\TechnicalDevelopmentPlan.odt | range: 327600-331600 -->

& Credits (two‑sided)** with monthly caps, ID gate,
device/IP fraud checks, and **clawback if first booking is refunded for
fraud**.

NonTechBlueprint

• **Global Safe‑Mode** defaults and comms constraints for 18+ material.

NonTechBlueprint

We will not leave §1.16 until the checklist at the end is met.

## **1.16.A Canon & invariants**

1691. **Respect Safe‑Mode & policy** in all growth surfaces (SFW
      previews publicly; 18+ only in‑app with Safe‑Mode OFF).

NonTechBlueprint

1692. **No spam:** per‑search alert frequency **≤1/day**; weekly digest
      opt‑in; easy "pause 30 days."

NonTechBlueprint

1693. **Evidence & attribution:** all growth sends include **UTM** and
      first‑party click tokens so conversions are attributable in §1.13.

NonTechBlueprint

1694. **Abuse‑resistant referrals:** hard caps, ID checks, same
      device/IP detection, and **credit clawback** if the first booking
      is fraudulent/refunded.

NonTechBlueprint

1695. **Cost‑conscious**: serverless jobs (EventBridge Scheduler +
      Lambda), dedupe in DynamoDB with TTL, SES/SNS for comms (no heavy
      third‑party tools).

## **1.16.B Data model (Aurora + Dynamo + Typesense)**

### **B.1 Aurora (source of truth)**

*\-- Saved searches (people & studios)*\
*create table saved_search (*\
*search_id text primary key, \-- ssv\_\...*\
*user_id text not null, \-- usr\_\...*\
*scope text not null check (scope in (\'people\',\'studios\')),*\
*query_json jsonb not null, \-- normalized filters (ANY/ALL groups)*\
*city text not null,*\
*paused_until date, \-- 30-day pause*\
*last_alert_dt date, \-- last day an alert was sent*\
*created_at timestamptz not null default now(),*\
*updated_at timestamptz not null default now()*\
*);*\
\
*\-- Alert sends (daily dedupe)*\
*create table saved_search_alert (*\
*alert_id text primary key, \-- ssa\_\...*\
*search_id text not null references saved_search(search_id) on delete
cascade,*\
*alert_dt date not null,*\
*match_count int not null,*\
*email_sent boolean not null default false,*\
*inapp_created boolean not null default false,*\
*created_at timestamptz not null default now(),*\
*unique (search_id, alert_dt)*\
*);*\
\
*\-- Follow graph (for Feed)*\
*create table follow (*\
*follower_user_id text not null,*\
*target_id text not null, \-- usr\_\... (people) or fsc\_\... (Fan-Sub
creator)*\
*target_kind text not null check (target_kind in
(\'service_profile\',\'fansub_creator\')),*\
*created_at timestamptz not null default now(),*\
*primary key (follower_user_id, target_id, target_kind)*\
*);*\
\
*\-- Feed posts metadata (case studies, availability cards, touring
chips, verified studio slots)*\
*create table feed_post (*\
*feed_id text primary key, \-- fdp\_\...*\
*author_id text not null, \-- usr\_\... or fsc\_\...*\
*role_tags text\[\] not null, \-- \[\'Model\',\'Photog\',\...\]*\
*kind text not null check (kind in
(\'case_study\',\'availability\',\'touring\',\'studio_slot\',\'influence\')),*\
*title text not null,*\
*body_md text,*\
*media_preview jsonb not null default \'\[\]\'::jsonb, \-- SFW
previews*\
*nsfw_band int not null default 0, \-- 0 allow,1 blur,2 block*\
*city text, \-- for touring/availability*\
*verified_chip boolean not null default false,*\
*is_published boolean not null default false,*\
*created_at timestamptz not null default now(),*\
*updated_at timestamptz not null default now()*\
*);*\
\
*\-- Referrals & credits (ledger-based)*\
*create table referral_program (*\
*program_id text primary key, \-- rpr\_\...*\
*kind text not null check (kind in
(\'provider_invites_provider\',\'buyer_invites_buyer\',\'cross_side\')),*\
*reward_bips int not null default 0, \-- optional future %*\
*reward_fixed_cents int not null default 0, \-- e.g., \$1500 = \$15.00*\
*credit_scope text not null, \-- \'buyer_fee_only\' etc.*\
*monthly_cap int not null default 5, \-- per-user awards cap*\
*active boolean not null default true,*\
*created_at timestamptz not null default now()*\
*);*\
\
*create table referral