<!-- id: TD-0070 | source: ProjectPlans\TechnicalDevelopmentPlan.odt | range: 252000-256000 -->

, \"v\", \"occurred_at\", \"received_at\",
\"context\", \"ids\", \"payload\"\],*\
*\"properties\": {*\
*\"event\": { \"type\": \"string\", \"pattern\": \"\^\[a-z0-9\_.\]+\$\"
},*\
*\"v\": { \"type\": \"integer\", \"enum\": \[1\] },*\
*\"occurred_at\": { \"type\": \"string\", \"format\": \"date-time\" },*\
*\"received_at\": { \"type\": \"string\", \"format\": \"date-time\" },*\
*\"user_id\": { \"type\": \"string\", \"pattern\":
\"\^usr\_\[A-Za-z0-9\]+\$\" },*\
*\"anon_id\": { \"type\": \"string\", \"pattern\":
\"\^an\_\[A-Za-z0-9\]+\$\" },*\
*\"session_id\": { \"type\": \"string\", \"pattern\":
\"\^ses\_\[A-Za-z0-9\]+\$\" },*\
*\"city\": { \"type\": \"string\" },*\
*\"device\": {*\
*\"type\": \"object\",*\
*\"properties\": {*\
*\"ua_hash\": { \"type\": \"string\" },*\
*\"os\": { \"type\": \"string\" },*\
*\"app_ver\": { \"type\": \"string\" }*\
*},*\
*\"additionalProperties\": false*\
*},*\
*\"context\": {*\
*\"type\": \"object\",*\
*\"required\": \[\"role\", \"env\"\],*\
*\"properties\": {*\
*\"role\": { \"type\": \"string\", \"enum\":
\[\"buyer\",\"seller\",\"studio_owner\",\"admin\",\"guest\"\] },*\
*\"env\": { \"type\": \"string\", \"enum\":
\[\"dev\",\"stage\",\"prod\"\] }*\
*},*\
*\"additionalProperties\": true*\
*},*\
*\"ids\": {*\
*\"type\": \"object\",*\
*\"properties\": {*\
*\"lbg_id\": { \"type\": \"string\", \"pattern\": \"\^lbg\_\" },*\
*\"leg_id\": { \"type\": \"string\", \"pattern\": \"\^leg\_\" },*\
*\"doc_id\": { \"type\": \"string\", \"pattern\": \"\^doc\_\" },*\
*\"impression_id\": { \"type\": \"string\", \"pattern\": \"\^imp\_\"
},*\
*\"campaign_id\": { \"type\": \"string\", \"pattern\": \"\^pcmp\_\" }*\
*},*\
*\"additionalProperties\": true*\
*},*\
*\"money\": {*\
*\"type\": \"object\",*\
*\"properties\": {*\
*\"amount_cents\": { \"type\": \"integer\", \"minimum\": 0 },*\
*\"currency\": { \"type\": \"string\", \"minLength\": 3, \"maxLength\":
3 }*\
*},*\
*\"additionalProperties\": false*\
*},*\
*\"payload\": { \"type\": \"object\" }*\
*},*\
*\"additionalProperties\": false*\
*}*\

**PII‑free rule:** No names, emails, phones, exact addresses, or images
in events. Join to PII only inside **Silver private** models when
absolutely necessary.

### **C.2 Example event schemas (selected)**

- search.card_impression.v1

*{*\
*\"\$id\": \".../search.card_impression.v1.json\",*\
*\"type\": \"object\",*\
*\"required\":
\[\"query_hash\",\"result_pos\",\"target_type\",\"target_id\",\"filters\"\],*\
*\"properties\": {*\
*\"query_hash\": { \"type\":\"string\" },*\
*\"result_pos\": { \"type\":\"integer\", \"minimum\": 1 },*\
*\"target_type\": { \"type\":\"string\",
\"enum\":\[\"service_profile\",\"studio\"\] },*\
*\"target_id\": { \"type\":\"string\" },*\
*\"filters\": { \"type\":\"object\" }*\
*}*\
*}*\

- lbg.confirmed.v1

*{*\
*\"\$id\": \".../lbg.confirmed.v1.json\",*\
*\"type\": \"object\",*\
*\"required\": \[\"leg_count\",\"payment_method\",\"total_cents\"\],*\
*\"properties\": {*\
*\"leg_count\": { \"type\":\"integer\",\"minimum\":1 },*\
*\"payment_method\": { \"type\":\"string\",\"enum\":\[\"card\",\"ach\"\]
},*\
*\"total_cents\": { \"type\":\"integer\",\"minimum\":0 },*\
*\"has_deposit_auth\": { \"type\":\"boolean\" }*\
*}*\
*}*\

- promo.click.v1

*{*\
*\"\$id\": \".../promo.click.v1.json\",*\
*\"type\": \"object\",*\
*\"required\": \[\"impression_id\",\"campaign_id\",\"valid\"\],*\
*\"properties\": {*\
*\"impression_id\": { \"type\":\"string\" },*\
*\"campaign_id\": { \"type\":\"string\" },*\
*\"valid\": { \"type\":\"boolean\" },*\
*\"invalid_reason\": { \"type\":\"string\" }*\
*}*\
*}*\

- payout.paid.v1

*{*\
*\"\$id\":\".../payout.paid.v1.json\",*\
*\"type\":\"object\",*\
*\"required\":\[\"leg_id\",\"amount_cents\",\"provider_ref\"\],*\
*\"properties\":{*\
*\"leg_id\":{\"type\":\"string\"},*\
*\"amount_cents\":{\"type\":\"integer\",\"minimum\":0},*\
*\"provider_ref\":{\"type\":\"string\"}*\
*}*\
*}*\

**Versioning:** Backward‑compatible field additions do not bump *v*;
breaking changes → new schema id and *v+