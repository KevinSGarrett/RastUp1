<!-- id: TD-0210 | source: ProjectPlans\TechnicalDevelopmentPlan.odt | range: 756000-760000 -->

edulePicker/\** --- candidate picker.
- *observability/dashboards/calendar.md* --- KPIs & alert specs.
- *ops/runbooks/calendar-ics-errors.md* --- feed error handling &
  back‑off.

## **1.12.15 Acceptance criteria --- mark §1.12 FINAL only when ALL true**

3434. Providers can configure availability (weekly + exceptions), lead
      time, booking window, and min duration; preview bookable slots.
3435. **Feasible slots** drive IB/RTB; checkout/reschedule validates
      freshness via holds; **hold→event** conversion is atomic.
3436. **ICS outbound** attached to booking/reschedule emails; optional
      **ICS feed** per user works and is tokenized.
3437. **ICS import (MVP)** ingests external busy events with ETag
      caching; polling is adaptive and cost‑controlled.
3438. Time zone & DST edge cases behave correctly (tests pass).
3439. Observability dashboards live; alarms trigger on poller errors and
      feasibility latency; cache hit rate meets target.

# **§1.13 --- Checkout, Payments, Pricing, Taxes & Payouts --- Full Technical Development Plan**

**Purpose.** Deliver a compliant, cost‑conscious, and extensible money
flow:

- **Buyer checkout** (cards/Apple Pay/Google Pay/ACH), **escrow‑style**
  capture/settlement around the service date, deposits, refunds, and
  partial credits.
- **Provider payouts** (Stripe Connect) with **IDV/KYC gating**,
  schedules, holds, and reconciliation.
- **Fees, taxes & invoices** with transparent breakdowns and
  downloadable receipts.
- **Disputes/chargebacks**, **refund policy enforcement**, and
  **ledger‑accurate** accounting.
- Elastic from build → launch → growth; no vendor lock‑in (adapters).

**Chosen vendors (MVP, cost‑aware):**

- **Stripe** (Payments + **Connect** Standard) for cards + wallets;
  **ACH** via **Plaid** (optional; see below) or **Stripe Financial
  Connections**.
- **Tax**: Start with Stripe Tax (Phase‑1), with an adapter abstraction
  for future Avalara/TaxJar if needed.
- **Currency**: USD at launch; multi‑currency ready in contracts but
  off.

*(You asked earlier to use Stripe and requested advice on Plaid: see
§1.13.6.)*

## **1.13.1 Scope → Technical**

- **Checkout**: quote → fees/taxes → payment intent →
  capture/authorization timing (deposit vs full) → booking create.
- **Escrow mechanics**: authorization/capture schedule tied to event
  time; automatic partial refunds for reschedules/cancellations per
  policy.
- **Provider payouts**: Connect onboarding (IDV/KYC), payout schedules,
  negative balances, reserve holds, reconciliation.
- **Refunds & adjustments**: provider/buyer‑initiated within policy;
  admin overrides; audit trail.
- **Disputes/chargebacks**: evidence pack automation (media, chat,
  timelines, deliverables, policy).
- **Invoicing/receipts**: PDF receipts; 1099‑K readiness; download
  links.
- **Ledger**: double‑entry journal; idempotent webhooks; daily close.

## **1.13.2 Architecture (Amplify Gen‑2 posture)**

- Frontend (Next.js / RN)

  - **Checkout** UI: pricing breakdown, fees, coupons, taxes, deposit
    toggle; Apple Pay/Google Pay; ACH option when available.
  - **Payouts**: Provider "Payouts" settings → Stripe Connect onboarding
    (hosted), status, balances, tax forms.
  - **Receipts**: View/download receipts & invoices.

- Backend

  - **AppSync GraphQL** resolvers → Lambda services: *pricing*,
    *checkout*, *payouts*, *refunds*, *ledger*.
  - **Stripe** SDK (server‑side) for PaymentIntents, SetupIntents,
    Refunds, Transfers, Connect accounts, Webhooks.
  - **Plaid/Financial Connections** (optional) for ACH/verification.
  - **Aurora Postgres** (*pay*, *acc* schemas) for ledger, quotes,
    invoices, payouts, policy snapshots.
  - **S3** for PDF receipts/invoices (private); **CloudFront signed
    URLs** for downloads.
  - **Event bus**: *checkout.initiated*, *payment.captured*,
    *payout.released*, *refund.issued*, *dispute.\** →
    analytics/notifications.

- **Cost posture**: Serverless functions; minimal Stripe p