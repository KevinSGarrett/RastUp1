<!-- id: TD-0196 | source: ProjectPlans\TechnicalDevelopmentPlan.odt | range: 705600-709600 -->

hema/reviews.graphql (additions)*\
*type StudioReview {*\
*id: ID!, orderId: ID!, studioId: ID!,*\
*side: ReviewSide!, rating: Int!, title: String, body: String,*\
*media: \[Media!\], status: ReviewStatus!, submittedAt: AWSDateTime,
publishedAt: AWSDateTime,*\
*helpfulUp: Int!, helpfulDown: Int!, reply: Reply*\
*}*\
*type StudioAggregate { studioId: ID!, avgRating: Float!, rcount: Int!,
dist: \[Int!\]!, bayesianAvg: Float! }*\
\
*extend type Query {*\
*studioReviews(studioId: ID!, page: Int = 1): \[StudioReview!\]!*\
*studioAggregate(studioId: ID!): StudioAggregate!*\
*}*\
*extend type Mutation {*\
*submitStudioReview(input: SubmitReviewInput!): ID! \# same guards:
verified booking, one-per-side, double-blind*\
*voteStudioReviewHelpful(input: VoteInput!): Boolean!*\
*reportStudioReview(input: ReportReviewInput!): ID!*\
*}*\

## **B) Dispute interplay & publication holds**

To avoid weaponizing reviews during active conflicts:

- If an order enters an **active dispute** (per §1.3 flows), we **hold
  publication** of any review for that order until the dispute is
  resolved or **14 days** after first submission **(whichever is
  later)**.
- Once resolved, if the financial outcome **materially changes** (e.g.,
  major refund), we append a small **"Resolved on {date}"** note to the
  published review for context (no PII, no amounts).
- Reviews can still be **submitted** during a dispute to preserve
  memory; they're just not **published** until safe.

## **C) Incentives & nudges (compliant; non‑monetary)**

Your plan references "Reviews, Reputation, & incentives." To remain
policy‑safe:

- **Nudges** only (no paid incentives):

  - Post‑completion in‑app banner: "Help others book confidently---leave
    a review (2--3 min)."
  - Profile nudges to providers: "Reply to new review" (improves trust).
  - Weekly digest card: "3 bookings awaiting your review."

- **Gamified---but private---badges** for buyers ("Consistent Reviewer")
  that **do not** affect search ranking and **are not** visible publicly
  (avoid biasing social proof).

- **Hard line**: no discounts, credits, or monetary compensation for
  leaving reviews.

## **D) Fraud & ring‑behavior detection**

Heuristics to detect and mitigate review rings or retaliation:

- **Anomaly signals**: many reviews from devices/IPs shared with the
  provider; unusual 1‑star/5‑star spikes; temporal bursts after
  disputes; high ratio of very short reviews with identical templates.

- **Actions** (progressive):

  - Reduce ranking weight (use Bayesian prior more heavily)
  - Soft‑review (hide from "Most relevant," show "Most recent")
  - Flag to T&S queue for manual review
  - Remove with reason code; strike if malicious

All decisions written to immutable audit.

## **E) SEO & visibility thresholds**

- **AggregateRating JSON‑LD**:

  - **Service Profiles**: include when *rcount ≥ 3* and page is **SFW**.
  - **Studio pages**: include when *rcount ≥ 3* and **SFW**.
  - Ensure reviews are **first‑party** and tied to **verified bookings**
    on our domain.

- Disable schema on low‑volume pages or when Safe‑Mode blurs a majority
  of review media.

## **F) Localization & accessibility**

- Reviews capture locale; sort options persist across locales.
- Text fields validated for basic profanity in **top languages** we
  serve; fall back to English list for others.
- Screen‑reader: star ratings announced as "4.6 out of 5, based on 32
  reviews."

## **G) Delta tests & acceptance addenda (append to prior §1.9 tests)**

**Add to Tests**

3217. **Studio path**: studio review submission/publish; SP pages never
      show studio reviews; Studio pages never show SP reviews.
3218. **Publication hold**: dispute active → reviews do not publish;
      after resolution/timeout → publish with "Resolved" note.
3219. **Thresholds**: JSON‑LD suppressed when *rcount \< 3* or page not
      SFW.
3220. **Fraud heuristics**: ring patterns lower weight → list order
      differs between "Most relevant" and "Most r