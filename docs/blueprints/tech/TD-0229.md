<!-- id: TD-0229 | source: ProjectPlans\TechnicalDevelopmentPlan.odt | range: 824400-828400 -->

pected;
      pagination stable.
3740. Book-Again 7/30/90 prefill works; opt-out honored; conversions
      attributed via UTM/click tokens.
3741. Referrals: awards after qualification; monthly caps; device/IP
      checks; clawbacks on fraud/refund.
3742. Attribution pipeline joins click tokens to checkout conversions in
      analytics.

## **10) Acceptance criteria (mark §1.16 FINAL only when ALL true)**

- Saved-searches (ANY/ALL) send **≤1/day** alerts with SFW previews;
  30-day pause works.
- Weekly digest ships; opt-in/out respected; **no 18+** content in
  email.
- Feed & Follow render correctly with role tabs, Verified chip,
  Safe-Mode gating.
- Book-Again at 7/30/90 works with draft checkout and opt-out.
- Referrals issue awards post-qualification, enforce caps/ID/device/IP
  rules, and **claw back** on fraud/refund.
- Attribution live; dashboards show alert/digest CTR, follower growth,
  book-again conversion, referral qualification.\
  \

# **§1.16 --- Growth, Retention & Referrals --- Gap‑close Addendum (finishing to ≥99.9%)**

In my last §1.16 delivery I covered Saved Searches & Alerts, Weekly
Digest, Feed & Follow, Book‑Again, Referrals, UTM/attribution,
schedules, DDL/GraphQL, tests, and acceptance. To reach your ≥99.9% bar
with no omissions, I'm adding the items below that tighten scope you
flagged in the non‑technical plan (and that I referenced but hadn't
fully specified): **Sharecards**, **Shortlinks & Deep Links**,
**Link‑in‑Bio**, **Touring announcements**, **Verified Spotlight &
fairness caps**, **Referral fraud hardening**, and a **first‑class
experimentation framework**.

I will **not** move on from §1.16 until these additions are in place.

## **1.16.11 Sharecards (OG images) & Shortlinks --- paste‑ready artifacts**

**Purpose.** Creators and studios need one‑click social sharing that
renders a branded **OpenGraph/Twitter Card** image with Safe‑Mode
thumbnails and deep‑links to the correct booking/search context.

### **A) Data model (Aurora, extend** ***growth*****)**

*begin;*\
\
*create table growth.sharecard_template (*\
*template_id text primary key, \-- sct\_\...*\
*kind text not null check (kind in
(\'service_profile\',\'studio\',\'case_study\',\'digest_pick\')),*\
*version int not null default 1,*\
*theme_json jsonb not null, \-- fonts, colors, layout tokens*\
*active boolean not null default true,*\
*created_at timestamptz default now()*\
*);*\
\
*create table growth.shortlink (*\
*code text primary key, \-- 6-8 char slug, e.g., r7Fa3K*\
*target_url text not null, \-- canonical deep link*\
*og_title text not null,*\
*og_desc text not null,*\
*og_image_s3 text not null, \-- rendered PNG path*\
*nsfw_band int not null default 0,*\
*expires_at timestamptz, \-- nullable (campaigns)*\
*created_by text not null, \-- usr\_\...*\
*created_at timestamptz default now()*\
*);*\
*commit;*\

### **B) Rendering service (serverless)**

- **Input**: *kind*, *entityId*, *locale*, *theme*.
- **Pipeline**: fetch entity (name, role chips, city, SFW preview from
  Media §1.11), feed into **Satori/ResVG** (React→SVG→PNG) or headless
  Chromium, write to *s3://assets/sharecards/{code}.png*.
- **Safe‑Mode**: if asset *sfw_band \> 0*, use blur/placeholder;
  email/push never embed NSFW.

### **C) Shortlink resolver**

- *GET /l/{code}* → resolve to *target_url*; set **OG meta**
  (*og:title*, *og:description*, *og:image*) for social platforms.
- Enforce **expiry**; do **not** 301 to external sites; always land to
  our domain with UTM preserved.

### **D) GraphQL (AppSync additions)**

*type Shortlink { code: ID!, url: AWSURL!, ogTitle: String!, ogDesc:
String!, expiresAt: AWSDateTime }*\
*type Mutation {*\
*createSharecard(kind: String!, entityId: ID!, theme: AWSJSON):
Shortlink! \@aws_cognito_user_pools*\
*}*\

### **E) Tests**

- SFW/NSFW previews, template versioning, expiry honors, OG tags present
  on resolver response, bots (Twitter/FB) fetch PNG successfully.

## **1.16.12 Link‑in‑Bio (publisher microsite)*